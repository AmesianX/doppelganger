var requirejs,require,define;!function(e){function t(e,t){return v.call(e,t)}function n(e,t){var n,i,r,o,a,s,l,c,u,h,p=t&&t.split("/"),f=g.map,d=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(p=p.slice(0,p.length-1),e=p.concat(e.split("/")),c=0;c<e.length;c+=1)if(h=e[c],"."===h)e.splice(c,1),c-=1;else if(".."===h){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||d)&&f){for(n=e.split("/"),c=n.length;c>0;c-=1){if(i=n.slice(0,c).join("/"),p)for(u=p.length;u>0;u-=1)if(r=f[p.slice(0,u).join("/")],r&&(r=r[i])){o=r,a=c;break}if(o)break;!s&&d&&d[i]&&(s=d[i],l=c)}!o&&s&&(o=s,a=l),o&&(n.splice(0,a,o),e=n.join("/"))}return e}function i(t,n){return function(){return u.apply(e,y.call(arguments,0).concat([t,n]))}}function r(e){return function(t){return n(t,e)}}function o(e){return function(t){f[e]=t}}function a(n){if(t(d,n)){var i=d[n];delete d[n],m[n]=!0,c.apply(e,i)}if(!t(f,n)&&!t(m,n))throw new Error("No "+n);return f[n]}function s(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function l(e){return function(){return g&&g.config&&g.config[e]||{}}}var c,u,h,p,f={},d={},g={},m={},v=Object.prototype.hasOwnProperty,y=[].slice;h=function(e,t){var i,o=s(e),l=o[0];return e=o[1],l&&(l=n(l,t),i=a(l)),l?e=i&&i.normalize?i.normalize(e,r(t)):n(e,t):(e=n(e,t),o=s(e),l=o[0],e=o[1],l&&(i=a(l))),{f:l?l+"!"+e:e,n:e,pr:l,p:i}},p={require:function(e){return i(e)},exports:function(e){var t=f[e];return"undefined"!=typeof t?t:f[e]={}},module:function(e){return{id:e,uri:"",exports:f[e],config:l(e)}}},c=function(n,r,s,l){var c,u,g,v,y,b,w=[];if(l=l||n,"function"==typeof s){for(r=!r.length&&s.length?["require","exports","module"]:r,y=0;y<r.length;y+=1)if(v=h(r[y],l),u=v.f,"require"===u)w[y]=p.require(n);else if("exports"===u)w[y]=p.exports(n),b=!0;else if("module"===u)c=w[y]=p.module(n);else if(t(f,u)||t(d,u)||t(m,u))w[y]=a(u);else{if(!v.p)throw new Error(n+" missing "+u);v.p.load(v.n,i(l,!0),o(u),{}),w[y]=f[u]}g=s.apply(f[n],w),n&&(c&&c.exports!==e&&c.exports!==f[n]?f[n]=c.exports:g===e&&b||(f[n]=g))}else n&&(f[n]=s)},requirejs=require=u=function(t,n,i,r,o){return"string"==typeof t?p[t]?p[t](n):a(h(t,n).f):(t.splice||(g=t,n.splice?(t=n,n=i,i=null):t=e),n=n||function(){},"function"==typeof i&&(i=r,r=o),r?c(e,t,n,i):setTimeout(function(){c(e,t,n,i)},4),u)},u.config=function(e){return g=e,g.deps&&u(g.deps,g.callback),u},requirejs._defined=f,define=function(e,n,i){n.splice||(i=n,n=[]),t(f,e)||t(d,e)||(d[e]=[e,n,i])},define.amd={jQuery:!0}}(),define("vendor/almond",function(){}),function(){var e={};e.Point=function(e,t){this.X=e,this.Y=t},e.Rectangle=function(e,t,n,i){this.X=e,this.Y=t,this.Width=n,this.Height=i},e.Line=function(e,t,n,i){this.X1=e,this.Y1=t,this.X2=n,this.Y2=i},e.Hexagon=function(t,n,i){this.Points=[];var r=null,o=null;e.Hexagon.Static.ORIENTATION===e.Hexagon.Orientation.Normal?(r=(e.Hexagon.Static.WIDTH-e.Hexagon.Static.SIDE)/2,o=e.Hexagon.Static.HEIGHT/2,this.Points.push(new e.Point(r+n,i)),this.Points.push(new e.Point(r+e.Hexagon.Static.SIDE+n,i)),this.Points.push(new e.Point(e.Hexagon.Static.WIDTH+n,o+i)),this.Points.push(new e.Point(r+e.Hexagon.Static.SIDE+n,e.Hexagon.Static.HEIGHT+i)),this.Points.push(new e.Point(r+n,e.Hexagon.Static.HEIGHT+i)),this.Points.push(new e.Point(n,o+i))):(r=e.Hexagon.Static.WIDTH/2,o=(e.Hexagon.Static.HEIGHT-e.Hexagon.Static.SIDE)/2,this.Points.push(new e.Point(r+n,i)),this.Points.push(new e.Point(e.Hexagon.Static.WIDTH+n,o+i)),this.Points.push(new e.Point(e.Hexagon.Static.WIDTH+n,o+e.Hexagon.Static.SIDE+i)),this.Points.push(new e.Point(r+n,e.Hexagon.Static.HEIGHT+i)),this.Points.push(new e.Point(n,o+e.Hexagon.Static.SIDE+i)),this.Points.push(new e.Point(n,o+i))),this.Id=t,this.x=n,this.y=i,this.x1=r,this.y1=o,this.TopLeftPoint=new e.Point(this.x,this.y),this.BottomRightPoint=new e.Point(this.x+e.Hexagon.Static.WIDTH,this.y+e.Hexagon.Static.HEIGHT),this.MidPoint=new e.Point(this.x+e.Hexagon.Static.WIDTH/2,this.y+e.Hexagon.Static.HEIGHT/2),this.P1=new e.Point(n+r,i+o),this.selected=!1},e.Hexagon.prototype.draw=function(e,t,n){e.beginPath(),e.moveTo(this.Points[0].X,this.Points[0].Y);for(var i=1;i<this.Points.length;i++){var r=this.Points[i];e.lineTo(r.X,r.Y)}e.closePath(),e.lineWidth=2,e.strokeStyle=t||"#0c2731",(this.selected||n)&&(e.fillStyle=n||"rgba(0, 0, 0, 0.15)",e.fill()),t!==!1&&e.stroke()},e.Hexagon.prototype.isInBounds=function(t,n){return this.Contains(new e.Point(t,n))},e.Hexagon.prototype.isInHexBounds=function(e){return this.TopLeftPoint.X<e.X&&this.TopLeftPoint.Y<e.Y&&e.X<this.BottomRightPoint.X&&e.Y<this.BottomRightPoint.Y?!0:!1},e.Hexagon.prototype.Contains=function(e){var t=!1;if(this.isInHexBounds(e)){var n,i=0;for(n=0,i=this.Points.length-1;n<this.Points.length;i=n++){var r=this.Points[n],o=this.Points[i];(r.Y<=e.Y&&e.Y<o.Y||o.Y<=e.Y&&e.Y<r.Y)&&e.X<(o.X-r.X)*(e.Y-r.Y)/(o.Y-r.Y)+r.X&&(t=!t)}}return t},e.Hexagon.prototype.isOnScreen=function(e,t){var n=this.MidPoint,i=n.X+(e||0),r=n.Y+(t||0);return 0>i||i>window.innerWidth?!1:0>r||r>window.innerHeight?!1:!0},e.Hexagon.Orientation={Normal:0,Rotated:1},e.Hexagon.Static={HEIGHT:173.20508075688775,WIDTH:200,SIDE:100,ORIENTATION:e.Hexagon.Orientation.Normal,DRAWSTATS:!1},window.HT=e}(),define("vendor/hex/tools",function(){}),function(e){window.findHexWithSideLengthZAndRatio=function(t,n){t=t||50,n=n||1.1547;var i=Math.pow(n,2),r=(1+i)/i,o=t/i,a=(1-4*i)/(4*i)*Math.pow(t,2),s=(-o+Math.sqrt(Math.pow(o,2)-4*r*a))/(2*r),l=(2*s+t)/(2*n),c=2*s+t,u=2*l;e.Hexagon.Static.WIDTH=c,e.Hexagon.Static.HEIGHT=u,e.Hexagon.Static.SIDE=t},window.findHexWithWidthAndHeight=function(t,n){t=t||100,n=n||86.60254037844388;var i=-3,r=-2*t,o=Math.pow(t,2)+Math.pow(n,2),a=(-r-Math.sqrt(Math.pow(r,2)-4*i*o))/(2*i);e.Hexagon.Static.WIDTH=t,e.Hexagon.Static.HEIGHT=n,e.Hexagon.Static.SIDE=a}}(window.HT),define("vendor/hex/calculations",function(){}),function(e){e.Grid=function(t,n){this.Hexes=[],this.width=t,this.height=n;for(var i={},r=0,o=0;o+e.Hexagon.Static.HEIGHT<=n;){var a=0,s=0;1===r%2&&(s=e.Hexagon.Static.ORIENTATION===e.Hexagon.Orientation.Normal?(e.Hexagon.Static.WIDTH-e.Hexagon.Static.SIDE)/2+e.Hexagon.Static.SIDE:e.Hexagon.Static.WIDTH/2,a=1);for(var l=s;l+e.Hexagon.Static.WIDTH<=t;){var c=this.GetHexId(r,a),u=new e.Hexagon(c,l,o),h=a;e.Hexagon.Static.ORIENTATION===e.Hexagon.Orientation.Normal?u.PathCoOrdX=a:(u.PathCoOrdY=r,h=r),this.Hexes.push(u),i[h]||(i[h]=[]),i[h].push(u),a+=2,l+=e.Hexagon.Static.ORIENTATION===e.Hexagon.Orientation.Normal?e.Hexagon.Static.WIDTH+e.Hexagon.Static.SIDE:e.Hexagon.Static.WIDTH}r++,o+=e.Hexagon.Static.ORIENTATION===e.Hexagon.Orientation.Normal?e.Hexagon.Static.HEIGHT/2:(e.Hexagon.Static.HEIGHT-e.Hexagon.Static.SIDE)/2+e.Hexagon.Static.SIDE}for(var p in i){var f=i[p],d=Math.floor(p/2)+p%2;for(var g in f){var m=f[g];e.Hexagon.Static.ORIENTATION===e.Hexagon.Orientation.Normal?m.PathCoOrdY=d++:m.PathCoOrdX=d++}}},e.Grid.Static={Letters:"ABCDEFGHIJKLMNOPQRSTUVWXYZ"},e.Grid.prototype.GetHexId=function(t,n){for(var i=t,r="";i>25;)r=e.Grid.Static.Letters[i%26]+r,i-=26;return e.Grid.Static.Letters[i]+r+(n+1)},e.Grid.prototype.GetHexAt=function(e){for(var t in this.Hexes)if(this.Hexes[t].Contains(e))return this.Hexes[t];return null},e.Grid.prototype.getHexAtCenter=function(t,n){var i=new e.Point(t/2,n/2);for(var r in this.Hexes)if(this.Hexes[r].Contains(i))return this.Hexes[r];return null},e.Grid.prototype.getNearestHexFromAngle=function(t,n){n*=Math.PI/180;var i=e.Hexagon.Static.HEIGHT,r=e.Hexagon.Static.WIDTH,o=t.MidPoint,a=o.X+Math.sin(n)*r,s=o.Y+Math.cos(n)*i;return this.GetHexAt(new e.Point(a,s))},e.Grid.prototype.nearestHexFromCenter=function(e,t,n){var i,r=this.getHexAtCenter(e,t);return n!==!1&&(i=this.getNearestHexFromAngle(r,n)),i||r},e.Grid.prototype.GetHexDistance=function(e,t){var n=e.PathCoOrdX-t.PathCoOrdX,i=e.PathCoOrdY-t.PathCoOrdY;return(Math.abs(n)+Math.abs(i)+Math.abs(n-i))/2},e.Grid.prototype.GetHexById=function(e){for(var t in this.Hexes)if(this.Hexes[t].Id===e)return this.Hexes[t];return null},e.Grid.prototype.GetHexByCartesian=function(e,t){for(var n in this.Hexes)if(this.Hexes[n].PathCoOrdX===e&&this.Hexes[n].PathCoOrdY===t)return this.Hexes[n];return null},e.Grid.prototype.Cache=function(){var e=document.createElement("canvas"),t=e.getContext("2d");e.width=this.width,e.height=this.height;for(var n in this.Hexes)this.Hexes[n].draw(t);return this.selected&&this.selected.draw(t),this.cache=e,e},e.Grid.prototype.select=function(e){for(var t in this.Hexes)this.Hexes[t].selected=!1;e.selected=!0,this.selected=e},e.Grid.prototype.each=function(e,t){var n=0,i=this.Hexes.length;for(i;i>n;n++)e.call(t||this,this.Hexes[n]);return this},e.Grid.prototype.eachOnScreen=function(e,t,n,i){var r=0,o=this.Hexes.length;for(o;o>r;r++)this.Hexes[r].isOnScreen(e,t)&&n.call(i||this,this.Hexes[r])}}(window.HT),define("hex",["vendor/hex/tools","vendor/hex/calculations"],function(){}),function(){function e(e,t,n){for(var i=(n||0)-1,r=e?e.length:0;++i<r;)if(e[i]===t)return i;return-1}function t(t,n){var i=typeof n;if(t=t.cache,"boolean"==i||null==n)return t[n]?0:-1;"number"!=i&&"string"!=i&&(i="object");var r="number"==i?n:w+n;return t=(t=t[i])&&t[r],"object"==i?t&&e(t,n)>-1?0:-1:t?0:-1}function n(e){var t=this.cache,n=typeof e;if("boolean"==n||null==e)t[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var i="number"==n?e:w+e,r=t[n]||(t[n]={});"object"==n?(r[i]||(r[i]=[])).push(e):r[i]=!0}}function i(e){return e.charCodeAt(0)}function r(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||"undefined"==typeof n)return 1;if(i>n||"undefined"==typeof i)return-1}return e.index-t.index}function o(e){var t=-1,i=e.length,r=e[0],o=e[0|i/2],a=e[i-1];if(r&&"object"==typeof r&&o&&"object"==typeof o&&a&&"object"==typeof a)return!1;var s=l();s["false"]=s["null"]=s["true"]=s.undefined=!1;var c=l();for(c.array=e,c.cache=s,c.push=n;++t<i;)c.push(e[t]);return c}function a(e){return"\\"+et[e]}function s(){return m.pop()||[]}function l(){return v.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function c(e){return"function"!=typeof e.toString&&"string"==typeof(e+"")}function u(){}function h(e){e.length=0,m.length<_&&m.push(e)}function p(e){var t=e.cache;t&&p(t),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,v.length<_&&v.push(e)}function f(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var i=-1,r=n-t||0,o=Array(0>r?0:r);++i<r;)o[i]=e[t+i];return o}function d(n){function m(e){return e&&"object"==typeof e&&!lr(e)&&Oi.call(e,"__wrapped__")?e:new v(e)}function v(e,t){this.__chain__=!!t,this.__wrapped__=e}function _(e,t,n,i,r){if(n){var o=n(e);if("undefined"!=typeof o)return o}var a=It(e);if(!a)return e;var l=Wi.call(e);if(!G[l]||!or.nodeClass&&c(e))return e;var u=ir[l];switch(l){case W:case L:return new u(+e);case B:case Y:return new u(e);case U:return o=u(e.source,M.exec(e)),o.lastIndex=e.lastIndex,o}var p=lr(e);if(t){var d=!i;i||(i=s()),r||(r=s());for(var g=i.length;g--;)if(i[g]==e)return r[g];o=p?u(e.length):{}}else o=p?f(e):br({},e);return p&&(Oi.call(e,"index")&&(o.index=e.index),Oi.call(e,"input")&&(o.input=e.input)),t?(i.push(e),r.push(o),(p?yr:_r)(e,function(e,a){o[a]=_(e,t,n,i,r)}),d&&(h(i),h(r)),o):o}function et(e,t,n){if("function"!=typeof e)return Qn;if("undefined"==typeof t)return e;var i=e.__bindData__||or.funcNames&&!e.name;if("undefined"==typeof i){var r=O&&Pi.call(e);or.funcNames||!r||R.test(r)||(i=!0),(or.funcNames||!i)&&(i=!or.funcDecomp||O.test(r),sr(e,i))}if(i!==!0&&i&&1&i[1])return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)}}return Nn(e,t)}function nt(e,t,n,i){for(var r=(i||0)-1,o=e?e.length:0,a=[];++r<o;){var s=e[r];if(s&&"object"==typeof s&&"number"==typeof s.length&&(lr(s)||mt(s))){t||(s=nt(s,t,n));var l=-1,c=s.length,u=a.length;for(a.length+=c;++l<c;)a[u++]=s[l]}else n||a.push(s)}return a}function it(e,t,n,i,r,o){if(n){var a=n(e,t);if("undefined"!=typeof a)return!!a}if(e===t)return 0!==e||1/e==1/t;var l=typeof e,u=typeof t;if(!(e!==e||e&&Z[l]||t&&Z[u]))return!1;if(null==e||null==t)return e===t;var p=Wi.call(e),f=Wi.call(t);if(p==F&&(p=X),f==F&&(f=X),p!=f)return!1;switch(p){case W:case L:return+e==+t;case B:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case U:case Y:return e==xi(t)}var d=p==z;if(!d){if(Oi.call(e,"__wrapped__ ")||Oi.call(t,"__wrapped__"))return it(e.__wrapped__||e,t.__wrapped__||t,n,i,r,o);if(p!=X||!or.nodeClass&&(c(e)||c(t)))return!1;var g=!or.argsObject&&mt(e)?bi:e.constructor,m=!or.argsObject&&mt(t)?bi:t.constructor;if(g!=m&&!(Pt(g)&&g instanceof g&&Pt(m)&&m instanceof m))return!1}var v=!r;r||(r=s()),o||(o=s());for(var y=r.length;y--;)if(r[y]==e)return o[y]==t;var b=0;if(a=!0,r.push(e),o.push(t),d){if(y=e.length,b=t.length,a=b==e.length,!a&&!i)return a;for(;b--;){var w=y,x=t[b];if(i)for(;w--&&!(a=it(e[w],x,n,i,r,o)););else if(!(a=it(e[b],x,n,i,r,o)))break}return a}return xr(t,function(t,s,l){return Oi.call(l,s)?(b++,a=Oi.call(e,s)&&it(e[s],t,n,i,r,o)):void 0}),a&&!i&&xr(e,function(e,t,n){return Oi.call(n,t)?a=--b>-1:void 0}),v&&(h(r),h(o)),a}function ot(e,t,n,i,r){(lr(t)?Qt:_r)(t,function(t,o){var a,s,l=t,c=e[o];if(t&&((s=lr(t))||Cr(t))){for(var u=i.length;u--;)if(a=i[u]==t){c=r[u];break}if(!a){var h;n&&(l=n(c,t),(h="undefined"!=typeof l)&&(c=l)),h||(c=s?lr(c)?c:[]:Cr(c)?c:{}),i.push(t),r.push(c),h||ot(c,t,n,i,r)}}else n&&(l=n(c,t),"undefined"==typeof l&&(l=t)),"undefined"!=typeof l&&(c=l);e[o]=c})}function st(n,i,r){var a=-1,l=ft(),c=n?n.length:0,u=[],f=!i&&c>=x&&l===e,d=r||f?s():u;if(f){var g=o(d);g?(l=t,d=g):(f=!1,d=r?d:(h(d),u))}for(;++a<c;){var m=n[a],v=r?r(m,a,n):m;(i?!a||d[d.length-1]!==v:l(d,v)<0)&&((r||f)&&d.push(v),u.push(m))}return f?(h(d.array),p(d)):r&&h(d),u}function lt(e){return function(t,n,i){var r={};if(n=m.createCallback(n,i,3),lr(t))for(var o=-1,a=t.length;++o<a;){var s=t[o];e(r,s,n(s,o,t),t)}else yr(t,function(t,i,o){e(r,t,n(t,i,o),o)});return r}}function ct(e,t,n,i,r,o){var a=1&t,s=2&t,l=4&t,c=8&t,u=16&t,h=32&t,p=e;if(!s&&!Pt(e))throw new _i;u&&!n.length&&(t&=-17,u=n=!1),h&&!i.length&&(t&=-33,h=i=!1);var f=e&&e.__bindData__;if(f)return!a||1&f[1]||(f[4]=r),!a&&1&f[1]&&(t|=8),!l||4&f[1]||(f[5]=o),u&&Ni.apply(f[2]||(f[2]=[]),n),h&&Ni.apply(f[3]||(f[3]=[]),i),f[1]|=t,ct.apply(null,f);if(!a||s||l||h||!(or.fastBind||qi&&u))g=function(){var f=arguments,d=a?r:this;if((l||u||h)&&(f=er.call(f),u&&Li.apply(f,n),h&&Ni.apply(f,i),l&&f.length<o))return t|=16,ct(e,c?t:-4&t,f,null,r,o);if(s&&(e=d[p]),this instanceof g){d=ht(e.prototype);var m=e.apply(d,f);return It(m)?m:d}return e.apply(d,f)};else{if(u){var d=[r];Ni.apply(d,n)}var g=u?qi.apply(e,d):qi.call(e,r)}return sr(g,er.call(arguments)),g}function ut(){Q.shadowedProps=j,Q.array=Q.bottom=Q.loop=Q.top="",Q.init="iterable",Q.useHas=!0;for(var e,t=0;e=arguments[t];t++)for(var n in e)Q[n]=e[n];var i=Q.args;Q.firstArg=/^[^,]+/.exec(i)[0];var r=mi("baseCreateCallback, errorClass, errorProto, hasOwnProperty, indicatorObject, isArguments, isArray, isString, keys, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+i+") {\n"+ar(Q)+"\n}");return r(et,$,ki,Oi,b,mt,lr,Vt,Q.keys,Si,Z,rr,Y,Ei,Wi)}function ht(e){return It(e)?Bi(e):{}}function pt(e){return dr[e]}function ft(){var t=(t=m.indexOf)===wn?e:t;return t}function dt(e){var t,n;return!e||Wi.call(e)!=X||(t=e.constructor,Pt(t)&&!(t instanceof t))||!or.argsClass&&mt(e)||!or.nodeClass&&c(e)?!1:or.ownLast?(xr(e,function(e,t,i){return n=Oi.call(i,t),!1}),n!==!1):(xr(e,function(e,t){n=t}),"undefined"==typeof n||Oi.call(e,n))}function gt(e){return gr[e]}function mt(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Wi.call(e)==F||!1}function vt(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n=t,t=!1),_(e,t,"function"==typeof n&&et(n,i,1))}function yt(e,t,n){return _(e,!0,"function"==typeof t&&et(t,n,1))}function bt(e,t,n){var i;return t=m.createCallback(t,n,3),_r(e,function(e,n,r){return t(e,n,r)?(i=n,!1):void 0}),i}function wt(e,t,n){var i;return t=m.createCallback(t,n,3),_t(e,function(e,n,r){return t(e,n,r)?(i=n,!1):void 0}),i}function xt(e,t,n){var i=[];xr(e,function(e,t){i.push(t,e)});var r=i.length;for(t=et(t,n,3);r--&&t(i[r--],i[r],e)!==!1;);return e}function _t(e,t,n){var i=ur(e),r=i.length;for(t=et(t,n,3);r--;){var o=i[r];if(t(e[o],o,e)===!1)break}return e}function Ct(e){var t=[];return xr(e,function(e,n){Pt(e)&&t.push(n)}),t.sort()}function kt(e,t){return e?Oi.call(e,t):!1}function St(e){for(var t=-1,n=ur(e),i=n.length,r={};++t<i;){var o=n[t];r[e[o]]=o}return r}function Et(e){return e===!0||e===!1||Wi.call(e)==W}function Tt(e){return e?"object"==typeof e&&Wi.call(e)==L:!1}function Ht(e){return e?1===e.nodeType:!1}function Mt(e){var t=!0;if(!e)return t;var n=Wi.call(e),i=e.length;return n==z||n==Y||(or.argsClass?n==F:mt(e))||n==X&&"number"==typeof i&&Pt(e.splice)?!i:(_r(e,function(){return t=!1}),t)}function Rt(e,t,n,i){return it(e,t,"function"==typeof n&&et(n,i,2))}function At(e){return Ui(e)&&!Yi(parseFloat(e))}function Pt(e){return"function"==typeof e}function It(e){return!(!e||!Z[typeof e])}function Ot(e){return Nt(e)&&e!=+e}function Dt(e){return null===e}function Nt(e){return"number"==typeof e||Wi.call(e)==B}function jt(e){return e&&Z[typeof e]?Wi.call(e)==U:!1}function Vt(e){return"string"==typeof e||Wi.call(e)==Y}function Ft(e){return"undefined"==typeof e}function zt(e){var t=arguments,n=2;if(!It(e))return e;if("number"!=typeof t[2]&&(n=t.length),n>3&&"function"==typeof t[n-2])var i=et(t[--n-1],t[n--],2);else n>2&&"function"==typeof t[n-1]&&(i=t[--n]);for(var r=er.call(arguments,1,n),o=-1,a=s(),l=s();++o<n;)ot(e,r[o],i,a,l);return h(a),h(l),e}function Wt(e,t,n){var i=ft(),r="function"==typeof t,o={};if(r)t=m.createCallback(t,n,3);else var a=nt(arguments,!0,!1,1);return xr(e,function(e,n,s){(r?!t(e,n,s):i(a,n)<0)&&(o[n]=e)}),o}function Lt(e){for(var t=-1,n=ur(e),i=n.length,r=pi(i);++t<i;){var o=n[t];r[t]=[o,e[o]]}return r}function $t(e,t,n){var i={};if("function"!=typeof t)for(var r=-1,o=nt(arguments,!0,!1,1),a=It(e)?o.length:0;++r<a;){var s=o[r];s in e&&(i[s]=e[s])}else t=m.createCallback(t,n,3),xr(e,function(e,n,r){t(e,n,r)&&(i[n]=e)});return i}function qt(e,t,n,i){var r=lr(e);if(t=et(t,i,4),null==n)if(r)n=[];else{var o=e&&e.constructor,a=o&&o.prototype;n=ht(a)}return(r?yr:_r)(e,function(e,i,r){return t(n,e,i,r)}),n}function Bt(e){for(var t=-1,n=ur(e),i=n.length,r=pi(i);++t<i;)r[t]=e[n[t]];return r}function Xt(e){var t=arguments,n=-1,i=nt(t,!0,!1,1),r=t[2]&&t[2][t[1]]===e?1:i.length,o=pi(r);for(or.unindexedChars&&Vt(e)&&(e=e.split(""));++n<r;)o[n]=e[i[n]];return o}function Ut(e,t,n){var i=-1,r=ft(),o=e?e.length:0,a=!1;return n=(0>n?Ji(0,o+n):n)||0,lr(e)?a=r(e,t,n)>-1:"number"==typeof o?a=(Vt(e)?e.indexOf(t,n):r(e,t,n))>-1:yr(e,function(e){return++i>=n?!(a=e===t):void 0}),a}function Yt(e,t,n){var i=!0;if(t=m.createCallback(t,n,3),lr(e))for(var r=-1,o=e.length;++r<o&&(i=!!t(e[r],r,e)););else yr(e,function(e,n,r){return i=!!t(e,n,r)});return i}function Gt(e,t,n){var i=[];if(t=m.createCallback(t,n,3),lr(e))for(var r=-1,o=e.length;++r<o;){var a=e[r];t(a,r,e)&&i.push(a)}else yr(e,function(e,n,r){t(e,n,r)&&i.push(e)});return i}function Jt(e,t,n){if(t=m.createCallback(t,n,3),!lr(e)){var i;return yr(e,function(e,n,r){return t(e,n,r)?(i=e,!1):void 0}),i}for(var r=-1,o=e.length;++r<o;){var a=e[r];if(t(a,r,e))return a}}function Kt(e,t,n){var i;return t=m.createCallback(t,n,3),Zt(e,function(e,n,r){return t(e,n,r)?(i=e,!1):void 0}),i}function Qt(e,t,n){if(t&&"undefined"==typeof n&&lr(e))for(var i=-1,r=e.length;++i<r&&t(e[i],i,e)!==!1;);else yr(e,t,n);return e}function Zt(e,t,n){var i=e,r=e?e.length:0;if(t=t&&"undefined"==typeof n?t:et(t,n,3),lr(e))for(;r--&&t(e[r],r,e)!==!1;);else{if("number"!=typeof r){var o=ur(e);r=o.length}else or.unindexedChars&&Vt(e)&&(i=e.split(""));yr(e,function(e,n,a){return n=o?o[--r]:--r,t(i[n],n,a)})}return e}function en(e,t){var n=er.call(arguments,2),i=-1,r="function"==typeof t,o=e?e.length:0,a=pi("number"==typeof o?o:0);return Qt(e,function(e){a[++i]=(r?t:e[t]).apply(e,n)}),a}function tn(e,t,n){var i=-1,r=e?e.length:0,o=pi("number"==typeof r?r:0);if(t=m.createCallback(t,n,3),lr(e))for(;++i<r;)o[i]=t(e[i],i,e);else yr(e,function(e,n,r){o[++i]=t(e,n,r)});return o}function nn(e,t,n){var r=-1/0,o=r;if(!t&&lr(e))for(var a=-1,s=e.length;++a<s;){var l=e[a];l>o&&(o=l)}else t=!t&&Vt(e)?i:m.createCallback(t,n,3),yr(e,function(e,n,i){var a=t(e,n,i);a>r&&(r=a,o=e)});return o}function rn(e,t,n){var r=1/0,o=r;if(!t&&lr(e))for(var a=-1,s=e.length;++a<s;){var l=e[a];o>l&&(o=l)}else t=!t&&Vt(e)?i:m.createCallback(t,n,3),yr(e,function(e,n,i){var a=t(e,n,i);r>a&&(r=a,o=e)});return o}function on(e,t,n,i){var r=arguments.length<3;if(t=et(t,i,4),lr(e)){var o=-1,a=e.length;for(r&&(n=e[++o]);++o<a;)n=t(n,e[o],o,e)}else yr(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)});return n}function an(e,t,n,i){var r=arguments.length<3;return t=et(t,i,4),Zt(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function sn(e,t,n){return t=m.createCallback(t,n,3),Gt(e,function(e,n,i){return!t(e,n,i)})}function ln(e,t,n){var i=e?e.length:0;if("number"!=typeof i?e=Bt(e):or.unindexedChars&&Vt(e)&&(e=e.split("")),null==t||n)return e?e[ti(i-1)]:g;var r=cn(e);return r.length=Ki(Ji(0,t),r.length),r}function cn(e){var t=-1,n=e?e.length:0,i=pi("number"==typeof n?n:0);return Qt(e,function(e){var n=ti(++t);i[t]=i[n],i[n]=e}),i}function un(e){var t=e?e.length:0;return"number"==typeof t?t:ur(e).length}function hn(e,t,n){var i;if(t=m.createCallback(t,n,3),lr(e))for(var r=-1,o=e.length;++r<o&&!(i=t(e[r],r,e)););else yr(e,function(e,n,r){return!(i=t(e,n,r))});return!!i}function pn(e,t,n){var i=-1,o=e?e.length:0,a=pi("number"==typeof o?o:0);for(t=m.createCallback(t,n,3),Qt(e,function(e,n,r){var o=a[++i]=l();o.criteria=t(e,n,r),o.index=i,o.value=e}),o=a.length,a.sort(r);o--;){var s=a[o];a[o]=s.value,p(s)}return a}function fn(e){return e&&"number"==typeof e.length?or.unindexedChars&&Vt(e)?e.split(""):f(e):Bt(e)}function dn(e){for(var t=-1,n=e?e.length:0,i=[];++t<n;){var r=e[t];r&&i.push(r)}return i}function gn(n){var i=-1,r=ft(),a=n?n.length:0,s=nt(arguments,!0,!0,1),l=[],c=a>=x&&r===e;if(c){var u=o(s);u?(r=t,s=u):c=!1}for(;++i<a;){var h=n[i];r(s,h)<0&&l.push(h)}return c&&p(s),l}function mn(e,t,n){var i=-1,r=e?e.length:0;for(t=m.createCallback(t,n,3);++i<r;)if(t(e[i],i,e))return i;return-1}function vn(e,t,n){var i=e?e.length:0;for(t=m.createCallback(t,n,3);i--;)if(t(e[i],i,e))return i;return-1}function yn(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var o=-1;for(t=m.createCallback(t,n,3);++o<r&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e?e[0]:g;return f(e,0,Ki(Ji(0,i),r))}function bn(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n=i&&i[t]===e?null:t,t=!1),null!=n&&(e=tn(e,n,i)),nt(e,t)}function wn(t,n,i){if("number"==typeof i){var r=t?t.length:0;i=0>i?Ji(0,r+i):i||0}else if(i){var o=Mn(t,n);return t[o]===n?o:-1}return e(t,n,i)}function xn(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var o=r;for(t=m.createCallback(t,n,3);o--&&t(e[o],o,e);)i++}else i=null==t||n?1:t||i;return f(e,0,Ki(Ji(0,r-i),r))}function _n(n){for(var i=arguments,r=i.length,a=-1,l=s(),c=-1,u=ft(),f=n?n.length:0,d=[],g=s();++a<r;){var m=i[a];l[a]=u===e&&(m?m.length:0)>=x&&o(a?i[a]:g)}e:for(;++c<f;){var v=l[0];if(m=n[c],(v?t(v,m):u(g,m))<0){for(a=r,(v||g).push(m);--a;)if(v=l[a],(v?t(v,m):u(i[a],m))<0)continue e;d.push(m)}}for(;r--;)v=l[r],v&&p(v);return h(l),h(g),d}function Cn(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var o=r;for(t=m.createCallback(t,n,3);o--&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e?e[r-1]:g;return f(e,Ji(0,r-i))}function kn(e,t,n){var i=e?e.length:0;for("number"==typeof n&&(i=(0>n?Ji(0,i+n):Ki(n,i-1))+1);i--;)if(e[i]===t)return i;return-1}function Sn(e){for(var t=arguments,n=0,i=t.length,r=e?e.length:0;++n<i;)for(var o=-1,a=t[n];++o<r;)e[o]===a&&(zi.call(e,o--,1),r--);return e}function En(e,t,n){e=+e||0,n="number"==typeof n?n:+n||1,null==t&&(t=e,e=0);for(var i=-1,r=Ji(0,Mi((t-e)/(n||1))),o=pi(r);++i<r;)o[i]=e,e+=n;return o}function Tn(e,t,n){var i=-1,r=e?e.length:0,o=[];for(t=m.createCallback(t,n,3);++i<r;){var a=e[i];t(a,i,e)&&(o.push(a),zi.call(e,i--,1),r--)}return o}function Hn(e,t,n){if("number"!=typeof t&&null!=t){var i=0,r=-1,o=e?e.length:0;for(t=m.createCallback(t,n,3);++r<o&&t(e[r],r,e);)i++}else i=null==t||n?1:Ji(0,t);return f(e,i)}function Mn(e,t,n,i){var r=0,o=e?e.length:r;for(n=n?m.createCallback(n,i,1):Qn,t=n(t);o>r;){var a=r+o>>>1;n(e[a])<t?r=a+1:o=a}return r}function Rn(){return st(nt(arguments,!0,!0))}function An(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n=i&&i[t]===e?null:t,t=!1),null!=n&&(n=m.createCallback(n,i,3)),st(e,t,n)}function Pn(e){return gn(e,er.call(arguments,1))}function In(){for(var e=arguments.length>1?arguments:arguments[0],t=-1,n=e?nn(Tr(e,"length")):0,i=pi(0>n?0:n);++t<n;)i[t]=Tr(e,t);return i}function On(e,t){for(var n=-1,i=e?e.length:0,r={};++n<i;){var o=e[n];t?r[o]=t[n]:o&&(r[o[0]]=o[1])}return r}function Dn(e,t){if(!Pt(t))throw new _i;return function(){return--e<1?t.apply(this,arguments):void 0}}function Nn(e,t){return arguments.length>2?ct(e,17,er.call(arguments,2),null,t):ct(e,1,null,null,t)}function jn(e){for(var t=arguments.length>1?nt(arguments,!0,!1,1):Ct(e),n=-1,i=t.length;++n<i;){var r=t[n];e[r]=ct(e[r],1,null,null,e)}return e}function Vn(e,t){return arguments.length>2?ct(t,19,er.call(arguments,2),null,e):ct(t,3,null,null,e)}function Fn(){for(var e=arguments,t=e.length;t--;)if(!Pt(e[t]))throw new _i;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}}function zn(e,t,n){var i=typeof e;if(null==e||"function"==i)return et(e,t,n);if("object"!=i)return function(t){return t[e]};var r=ur(e),o=r[0],a=e[o];return 1!=r.length||a!==a||It(a)?function(t){for(var n=r.length,i=!1;n--&&(i=it(t[r[n]],e[r[n]],null,!0)););return i}:function(e){var t=e[o];return a===t&&(0!==a||1/a==1/t)}}function Wn(e,t){return t="number"==typeof t?t:+t||e.length,ct(e,4,null,null,null,t)}function Ln(e,t,n){var i,r,o,a,s,l,c,u=0,h=!1,p=!0;if(!Pt(e))throw new _i;if(t=Ji(0,t)||0,n===!0){var f=!0;p=!1}else It(n)&&(f=n.leading,h="maxWait"in n&&(Ji(t,n.maxWait)||0),p="trailing"in n?n.trailing:p);var d=function(){var n=t-(Di()-a);if(0>=n){r&&Ri(r);var h=c;r=l=c=g,h&&(u=Di(),o=e.apply(s,i))}else l=Fi(d,n)},m=function(){l&&Ri(l),r=l=c=g,(p||h!==t)&&(u=Di(),o=e.apply(s,i))};return function(){if(i=arguments,a=Di(),s=this,c=p&&(l||!f),h===!1)var n=f&&!l;else{r||f||(u=a);var g=h-(a-u);0>=g?(r&&(r=Ri(r)),u=a,o=e.apply(s,i)):r||(r=Fi(m,g))}return l||t===h||(l=Fi(d,t)),n&&(o=e.apply(s,i)),o}}function $n(e){if(!Pt(e))throw new _i;var t=er.call(arguments,1);return Fi(function(){e.apply(g,t)},1)}function qn(e,t){if(!Pt(e))throw new _i;var n=er.call(arguments,2);return Fi(function(){e.apply(g,n)},t)}function Bn(e,t){if(!Pt(e))throw new _i;var n=function(){var i=n.cache,r=t?t.apply(this,arguments):w+arguments[0];return Oi.call(i,r)?i[r]:i[r]=e.apply(this,arguments)};return n.cache={},n}function Xn(e){var t,n;if(!Pt(e))throw new _i;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function Un(e){return ct(e,16,er.call(arguments,1))}function Yn(e){return ct(e,32,null,er.call(arguments,1))}function Gn(e,t,n){var i=!0,r=!0;if(!Pt(e))throw new _i;n===!1?i=!1:It(n)&&(i="leading"in n?n.leading:i,r="trailing"in n?n.trailing:r),J.leading=i,J.maxWait=t,J.trailing=r;var o=Ln(e,t,J);return o}function Jn(e,t){if(!Pt(t))throw new _i;return function(){var n=[e];return Ni.apply(n,arguments),t.apply(this,n)}}function Kn(e){return null==e?"":xi(e).replace(vr,pt)}function Qn(e){return e}function Zn(e,t){var n=e,i=!t||Pt(n);t||(n=v,t=e,e=m),Qt(Ct(t),function(r){var o=e[r]=t[r];i&&(n.prototype[r]=function(){var t=this.__wrapped__,i=[t];Ni.apply(i,arguments);var r=o.apply(e,i);return t&&"object"==typeof t&&t===r?this:(r=new n(r),r.__chain__=this.__chain__,r)})})}function ei(){return n._=Ti,this}function ti(e,t,n){var i=null==e,r=null==t;null==n&&("boolean"==typeof e&&r?(n=e,e=1):r||"boolean"!=typeof t||(n=t,r=!0)),i&&r&&(t=1),e=+e||0,r?(t=e,e=0):t=+t||0;var o=Zi();return n||e%1||t%1?Ki(e+o*(t-e+parseFloat("1e-"+((o+"").length-1))),t):e+Ai(o*(t-e+1))}function ni(e,t){if(e){var n=e[t];return Pt(n)?e[t]():n}}function ii(e,t,n){var i=m.templateSettings;e||(e=""),n=wr({},n,i);var r,o=wr({},n.imports,i.imports),s=ur(o),l=Bt(o),c=0,u=n.interpolate||I,h="__p += '",p=wi((n.escape||I).source+"|"+u.source+"|"+(u===A?H:I).source+"|"+(n.evaluate||I).source+"|$","g");e.replace(p,function(t,n,i,o,s,l){return i||(i=o),h+=e.slice(c,l).replace(D,a),n&&(h+="' +\n__e("+n+") +\n'"),s&&(r=!0,h+="';\n"+s+";\n__p += '"),i&&(h+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),c=l+t.length,t}),h+="';\n";var f=n.variable,d=f;d||(f="obj",h="with ("+f+") {\n"+h+"\n}\n"),h=(r?h.replace(S,""):h).replace(E,"$1").replace(T,"$1;"),h="function("+f+") {\n"+(d?"":f+" || ("+f+" = {});\n")+"var __t, __p = '', __e = _.escape"+(r?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var v="\n/*\n//# sourceURL="+(n.sourceURL||"/lodash/template/source["+V++ +"]")+"\n*/";try{var y=mi(s,"return "+h+v).apply(g,l)}catch(b){throw b.source=h,b}return t?y(t):(y.source=h,y)}function ri(e,t,n){e=(e=+e)>-1?e:0;var i=-1,r=pi(e);for(t=et(t,n,1);++i<e;)r[i]=t(i);return r}function oi(e){return null==e?"":xi(e).replace(mr,gt)}function ai(e){var t=++y;return xi(null==e?"":e)+t}function si(e){return e=new v(e),e.__chain__=!0,e}function li(e,t){return t(e),e}function ci(){return this.__chain__=!0,this}function ui(){return xi(this.__wrapped__)}function hi(){return this.__wrapped__}n=n?at.defaults(tt.Object(),n,at.pick(tt,N)):tt;var pi=n.Array,fi=n.Boolean,di=n.Date,gi=n.Error,mi=n.Function,vi=n.Math,yi=n.Number,bi=n.Object,wi=n.RegExp,xi=n.String,_i=n.TypeError,Ci=[],ki=gi.prototype,Si=bi.prototype,Ei=xi.prototype,Ti=n._,Hi=wi("^"+xi(Si.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Mi=vi.ceil,Ri=n.clearTimeout,Ai=vi.floor,Pi=mi.prototype.toString,Ii=Hi.test(Ii=bi.getPrototypeOf)&&Ii,Oi=Si.hasOwnProperty,Di=Hi.test(Di=di.now)&&Di||function(){return+new di},Ni=Ci.push,ji=Si.propertyIsEnumerable,Vi=n.setImmediate,Fi=n.setTimeout,zi=Ci.splice,Wi=Si.toString,Li=Ci.unshift,$i=function(){try{var e={},t=Hi.test(t=bi.defineProperty)&&t,n=t(e,e,e)&&t}catch(i){}return n}(),qi=Hi.test(qi=Wi.bind)&&qi,Bi=Hi.test(Bi=bi.create)&&Bi,Xi=Hi.test(Xi=pi.isArray)&&Xi,Ui=n.isFinite,Yi=n.isNaN,Gi=Hi.test(Gi=bi.keys)&&Gi,Ji=vi.max,Ki=vi.min,Qi=n.parseInt,Zi=vi.random,er=Ci.slice,tr=Hi.test(n.attachEvent),nr=qi&&!/\n|true/.test(qi+tr),ir={};ir[z]=pi,ir[W]=fi,ir[L]=di,ir[q]=mi,ir[X]=bi,ir[B]=yi,ir[U]=wi,ir[Y]=xi;var rr={};rr[z]=rr[L]=rr[B]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},rr[W]=rr[Y]={constructor:!0,toString:!0,valueOf:!0},rr[$]=rr[q]=rr[U]={constructor:!0,toString:!0},rr[X]={constructor:!0},function(){for(var e=j.length;e--;){var t=j[e];for(var n in rr)Oi.call(rr,n)&&!Oi.call(rr[n],t)&&(rr[n][t]=!1)}}(),v.prototype=m.prototype;var or=m.support={};!function(){var e=function(){this.x=1},t={0:1,length:1},i=[];e.prototype={valueOf:1,y:1};for(var r in new e)i.push(r);for(r in arguments);or.argsClass=Wi.call(arguments)==F,or.argsObject=arguments.constructor==bi&&!(arguments instanceof pi),or.enumErrorProps=ji.call(ki,"message")||ji.call(ki,"name"),or.enumPrototypes=ji.call(e,"prototype"),or.fastBind=qi&&!nr,or.funcDecomp=!Hi.test(n.WinRTError)&&O.test(d),or.funcNames="string"==typeof mi.name,or.nonEnumArgs=0!=r,or.nonEnumShadows=!/valueOf/.test(i),or.ownLast="x"!=i[0],or.spliceObjects=(Ci.splice.call(t,0,1),!t[0]),or.unindexedChars="xx"!="x"[0]+bi("x")[0];try{or.nodeClass=!(Wi.call(document)==X&&!({toString:0}+""))
}catch(o){or.nodeClass=!0}}(1),m.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:A,variable:"",imports:{_:m}};var ar=function(e){var t="var index, iterable = "+e.firstArg+", result = "+e.init+";\nif (!iterable) return result;\n"+e.top+";";e.array?(t+="\nvar length = iterable.length; index = -1;\nif ("+e.array+") {  ",or.unindexedChars&&(t+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),t+="\n  while (++index < length) {\n    "+e.loop+";\n  }\n}\nelse {  "):or.nonEnumArgs&&(t+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+e.loop+";\n    }\n  } else {  "),or.enumPrototypes&&(t+="\n  var skipProto = typeof iterable == 'function';\n  "),or.enumErrorProps&&(t+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  ");var n=[];if(or.enumPrototypes&&n.push('!(skipProto && index == "prototype")'),or.enumErrorProps&&n.push('!(skipErrorProps && (index == "message" || index == "name"))'),e.useHas&&e.keys)t+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",n.length&&(t+="    if ("+n.join(" && ")+") {\n  "),t+=e.loop+";    ",n.length&&(t+="\n    }"),t+="\n  }  ";else if(t+="\n  for (index in iterable) {\n",e.useHas&&n.push("hasOwnProperty.call(iterable, index)"),n.length&&(t+="    if ("+n.join(" && ")+") {\n  "),t+=e.loop+";    ",n.length&&(t+="\n    }"),t+="\n  }    ",or.nonEnumShadows){for(t+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ",k=0;7>k;k++)t+="\n    index = '"+e.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",e.useHas||(t+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),t+=") {\n      "+e.loop+";\n    }      ";t+="\n  }    "}return(e.array||or.nonEnumArgs)&&(t+="\n}"),t+=e.bottom+";\nreturn result"};Bi||(ht=function(e){if(It(e)){u.prototype=e;var t=new u;u.prototype=null}return t||{}});var sr=$i?function(e,t){K.value=t,$i(e,"__bindData__",K)}:u;or.argsClass||(mt=function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Oi.call(e,"callee")||!1});var lr=Xi||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Wi.call(e)==z||!1},cr=ut({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),ur=Gi?function(e){return It(e)?or.enumPrototypes&&"function"==typeof e||or.nonEnumArgs&&e.length&&mt(e)?cr(e):Gi(e):[]}:cr,hr={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3)",array:"typeof length == 'number'",keys:ur,loop:"if (callback(iterable[index], index, collection) === false) return result"},pr={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",keys:ur,loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},fr={top:"if (!objectTypes[typeof iterable]) return result;\n"+hr.top,array:!1},dr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},gr=St(dr),mr=wi("("+ur(gr).join("|")+")","g"),vr=wi("["+ur(dr).join("")+"]","g"),yr=ut(hr),br=ut(pr,{top:pr.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),wr=ut(pr),xr=ut(hr,fr,{useHas:!1}),_r=ut(hr,fr);Pt(/x/)&&(Pt=function(e){return"function"==typeof e&&Wi.call(e)==q});var Cr=Ii?function(e){if(!e||Wi.call(e)!=X||!or.argsClass&&mt(e))return!1;var t=e.valueOf,n="function"==typeof t&&(n=Ii(t))&&Ii(n);return n?e==n||Ii(e)==n:dt(e)}:dt,kr=lt(function(e,t,n){Oi.call(e,n)?e[n]++:e[n]=1}),Sr=lt(function(e,t,n){(Oi.call(e,n)?e[n]:e[n]=[]).push(t)}),Er=lt(function(e,t,n){e[n]=t}),Tr=tn,Hr=Gt;nr&&rt&&"function"==typeof Vi&&($n=function(e){if(!Pt(e))throw new _i;return Vi.apply(n,arguments)});var Mr=8==Qi(C+"08")?Qi:function(e,t){return Qi(Vt(e)?e.replace(P,""):e,t||0)};return m.after=Dn,m.assign=br,m.at=Xt,m.bind=Nn,m.bindAll=jn,m.bindKey=Vn,m.chain=si,m.compact=dn,m.compose=Fn,m.countBy=kr,m.createCallback=zn,m.curry=Wn,m.debounce=Ln,m.defaults=wr,m.defer=$n,m.delay=qn,m.difference=gn,m.filter=Gt,m.flatten=bn,m.forEach=Qt,m.forEachRight=Zt,m.forIn=xr,m.forInRight=xt,m.forOwn=_r,m.forOwnRight=_t,m.functions=Ct,m.groupBy=Sr,m.indexBy=Er,m.initial=xn,m.intersection=_n,m.invert=St,m.invoke=en,m.keys=ur,m.map=tn,m.max=nn,m.memoize=Bn,m.merge=zt,m.min=rn,m.omit=Wt,m.once=Xn,m.pairs=Lt,m.partial=Un,m.partialRight=Yn,m.pick=$t,m.pluck=Tr,m.pull=Sn,m.range=En,m.reject=sn,m.remove=Tn,m.rest=Hn,m.shuffle=cn,m.sortBy=pn,m.tap=li,m.throttle=Gn,m.times=ri,m.toArray=fn,m.transform=qt,m.union=Rn,m.uniq=An,m.values=Bt,m.where=Hr,m.without=Pn,m.wrap=Jn,m.zip=In,m.zipObject=On,m.collect=tn,m.drop=Hn,m.each=Qt,m.eachRight=Zt,m.extend=br,m.methods=Ct,m.object=On,m.select=Gt,m.tail=Hn,m.unique=An,m.unzip=In,Zn(m),m.clone=vt,m.cloneDeep=yt,m.contains=Ut,m.escape=Kn,m.every=Yt,m.find=Jt,m.findIndex=mn,m.findKey=bt,m.findLast=Kt,m.findLastIndex=vn,m.findLastKey=wt,m.has=kt,m.identity=Qn,m.indexOf=wn,m.isArguments=mt,m.isArray=lr,m.isBoolean=Et,m.isDate=Tt,m.isElement=Ht,m.isEmpty=Mt,m.isEqual=Rt,m.isFinite=At,m.isFunction=Pt,m.isNaN=Ot,m.isNull=Dt,m.isNumber=Nt,m.isObject=It,m.isPlainObject=Cr,m.isRegExp=jt,m.isString=Vt,m.isUndefined=Ft,m.lastIndexOf=kn,m.mixin=Zn,m.noConflict=ei,m.parseInt=Mr,m.random=ti,m.reduce=on,m.reduceRight=an,m.result=ni,m.runInContext=d,m.size=un,m.some=hn,m.sortedIndex=Mn,m.template=ii,m.unescape=oi,m.uniqueId=ai,m.all=Yt,m.any=hn,m.detect=Jt,m.findWhere=Jt,m.foldl=on,m.foldr=an,m.include=Ut,m.inject=on,_r(m,function(e,t){m.prototype[t]||(m.prototype[t]=function(){var t=[this.__wrapped__],n=this.__chain__;Ni.apply(t,arguments);var i=e.apply(m,t);return n?new v(i,n):i})}),m.first=yn,m.last=Cn,m.sample=ln,m.take=yn,m.head=yn,_r(m,function(e,t){var n="sample"!==t;m.prototype[t]||(m.prototype[t]=function(t,i){var r=this.__chain__,o=e(this.__wrapped__,t,i);return r||null!=t&&(!i||n&&"function"==typeof t)?new v(o,r):o})}),m.VERSION="2.2.1",m.prototype.chain=ci,m.prototype.toString=ui,m.prototype.value=hi,m.prototype.valueOf=hi,yr(["join","pop","shift"],function(e){var t=Ci[e];m.prototype[e]=function(){var e=this.__chain__,n=t.apply(this.__wrapped__,arguments);return e?new v(n,e):n}}),yr(["push","reverse","sort","unshift"],function(e){var t=Ci[e];m.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),yr(["concat","slice","splice"],function(e){var t=Ci[e];m.prototype[e]=function(){return new v(t.apply(this.__wrapped__,arguments),this.__chain__)}}),or.spliceObjects||yr(["pop","shift","splice"],function(e){var t=Ci[e],n="splice"==e;m.prototype[e]=function(){var e=this.__chain__,i=this.__wrapped__,r=t.apply(i,arguments);return 0===i.length&&delete i[0],e||n?new v(r,e):r}}),m}var g,m=[],v=[],y=0,b={},w=+new Date+"",x=75,_=40,C=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",S=/\b__p \+= '';/g,E=/\b(__p \+=) '' \+/g,T=/(__e\(.*?\)|\b__t\)) \+\n'';/g,H=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,M=/\w*$/,R=/^function[ \n\r\t]+\w/,A=/<%=([\s\S]+?)%>/g,P=RegExp("^["+C+"]*0+(?=.$)"),I=/($^)/,O=/\bthis\b/,D=/['\n\r\t\u2028\u2029\\]/g,N=["Array","Boolean","Date","Error","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],j=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],V=0,F="[object Arguments]",z="[object Array]",W="[object Boolean]",L="[object Date]",$="[object Error]",q="[object Function]",B="[object Number]",X="[object Object]",U="[object RegExp]",Y="[object String]",G={};G[q]=!1,G[F]=G[z]=G[W]=G[L]=G[B]=G[X]=G[U]=G[Y]=!0;var J={leading:!1,maxWait:0,trailing:!1},K={configurable:!1,enumerable:!1,value:null,writable:!1},Q={args:"",array:null,bottom:"",firstArg:"",init:"",keys:null,loop:"",shadowedProps:null,support:null,top:"",useHas:!1},Z={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},et={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},tt=Z[typeof window]&&window||this,nt=Z[typeof exports]&&exports&&!exports.nodeType&&exports,it=Z[typeof module]&&module&&!module.nodeType&&module,rt=it&&it.exports===nt&&nt,ot=Z[typeof global]&&global;!ot||ot.global!==ot&&ot.window!==ot||(tt=ot);var at=d();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(tt._=at,define("lodash",[],function(){return at})):nt&&it?rt?(it.exports=at)._=at:nt._=at:tt._=at}.call(this),function(e,t){function n(e){var t=e.length,n=X.type(e);return X.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function i(e){var t=rt[e]={};return X.each(e.match(Y)||[],function(e,n){t[n]=!0}),t}function r(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=X.expando+Math.random()}function o(e,n,i){var r;if(i===t&&1===e.nodeType)if(r="data-"+n.replace(lt,"-$1").toLowerCase(),i=e.getAttribute(r),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:st.test(i)?JSON.parse(i):i}catch(o){}ot.set(e,n,i)}else i=t;return i}function a(){return!0}function s(){return!1}function l(){try{return P.activeElement}catch(e){}}function c(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function u(e,t,n){if(X.isFunction(t))return X.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return X.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(yt.test(t))return X.filter(t,e,n);t=X.filter(t,e)}return X.grep(e,function(e){return L.call(t,e)>=0!==n})}function h(e,t){return X.nodeName(e,"table")&&X.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function p(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function f(e){var t=Mt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function d(e,t){for(var n=e.length,i=0;n>i;i++)at.set(e[i],"globalEval",!t||at.get(t[i],"globalEval"))}function g(e,t){var n,i,r,o,a,s,l,c;if(1===t.nodeType){if(at.hasData(e)&&(o=at.access(e),a=at.set(t,o),c=o.events)){delete a.handle,a.events={};for(r in c)for(n=0,i=c[r].length;i>n;n++)X.event.add(t,r,c[r][n])}ot.hasData(e)&&(s=ot.access(e),l=X.extend({},s),ot.set(t,l))}}function m(e,n){var i=e.getElementsByTagName?e.getElementsByTagName(n||"*"):e.querySelectorAll?e.querySelectorAll(n||"*"):[];return n===t||n&&X.nodeName(e,n)?X.merge([e],i):i}function v(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Et.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function y(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),i=t,r=$t.length;r--;)if(t=$t[r]+n,t in e)return t;return i}function b(e,t){return e=t||e,"none"===X.css(e,"display")||!X.contains(e.ownerDocument,e)}function w(t){return e.getComputedStyle(t,null)}function x(e,t){for(var n,i,r,o=[],a=0,s=e.length;s>a;a++)i=e[a],i.style&&(o[a]=at.get(i,"olddisplay"),n=i.style.display,t?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&b(i)&&(o[a]=at.access(i,"olddisplay",S(i.nodeName)))):o[a]||(r=b(i),(n&&"none"!==n||!r)&&at.set(i,"olddisplay",r?n:X.css(i,"display"))));for(a=0;s>a;a++)i=e[a],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[a]||"":"none"));return e}function _(e,t,n){var i=Nt.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function C(e,t,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,a=0;4>o;o+=2)"margin"===n&&(a+=X.css(e,n+Lt[o],!0,r)),i?("content"===n&&(a-=X.css(e,"padding"+Lt[o],!0,r)),"margin"!==n&&(a-=X.css(e,"border"+Lt[o]+"Width",!0,r))):(a+=X.css(e,"padding"+Lt[o],!0,r),"padding"!==n&&(a+=X.css(e,"border"+Lt[o]+"Width",!0,r)));return a}function k(e,t,n){var i=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=w(e),a=X.support.boxSizing&&"border-box"===X.css(e,"boxSizing",!1,o);if(0>=r||null==r){if(r=Pt(e,t,o),(0>r||null==r)&&(r=e.style[t]),jt.test(r))return r;i=a&&(X.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+C(e,t,n||(a?"border":"content"),i,o)+"px"}function S(e){var t=P,n=Ft[e];return n||(n=E(e,t),"none"!==n&&n||(It=(It||X("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(It[0].contentWindow||It[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=E(e,t),It.detach()),Ft[e]=n),n}function E(e,t){var n=X(t.createElement(e)).appendTo(t.body),i=X.css(n[0],"display");return n.remove(),i}function T(e,t,n,i){var r;if(X.isArray(t))X.each(t,function(t,r){n||Bt.test(e)?i(e,r):T(e+"["+("object"==typeof r?t:"")+"]",r,n,i)});else if(n||"object"!==X.type(t))i(e,t);else for(r in t)T(e+"["+r+"]",t[r],n,i)}function H(e){return X.isWindow(e)?e:9===e.nodeType&&e.defaultView}var M,R,A=typeof t,P=(e.location,e.document),I=P.documentElement,O=e.jQuery,D=e.$,N={},j=[],V="2.0.3 -sizzle,-wrap,-ajax,-ajax/script,-ajax/jsonp,-ajax/xhr,-effects,-deprecated",F=j.concat,z=j.push,W=j.slice,L=j.indexOf,$=N.toString,q=N.hasOwnProperty,B=V.trim,X=function(e,t){return new X.fn.init(e,t,M)},U=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Y=/\S+/g,G=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,J=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,K=/^-ms-/,Q=/-([\da-z])/gi,Z=function(e,t){return t.toUpperCase()},et=function(){P.removeEventListener("DOMContentLoaded",et,!1),e.removeEventListener("load",et,!1),X.ready()};X.fn=X.prototype={jquery:V,constructor:X,init:function(e,n,i){var r,o;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:G.exec(e),!r||!r[1]&&n)return!n||n.jquery?(n||i).find(e):this.constructor(n).find(e);if(r[1]){if(n=n instanceof X?n[0]:n,X.merge(this,X.parseHTML(r[1],n&&n.nodeType?n.ownerDocument||n:P,!0)),J.test(r[1])&&X.isPlainObject(n))for(r in n)X.isFunction(this[r])?this[r](n[r]):this.attr(r,n[r]);return this}return o=P.getElementById(r[2]),o&&o.parentNode&&(this.length=1,this[0]=o),this.context=P,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):X.isFunction(e)?i.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),X.makeArray(e,this))},selector:"",length:0,toArray:function(){return W.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=X.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return X.each(this,e,t)},ready:function(e){return X.ready.promise().done(e),this},slice:function(){return this.pushStack(W.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(X.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:z,sort:[].sort,splice:[].splice},X.fn.init.prototype=X.fn,X.extend=X.fn.extend=function(){var e,n,i,r,o,a,s=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[1]||{},l=2),"object"==typeof s||X.isFunction(s)||(s={}),c===l&&(s=this,--l);c>l;l++)if(null!=(e=arguments[l]))for(n in e)i=s[n],r=e[n],s!==r&&(u&&r&&(X.isPlainObject(r)||(o=X.isArray(r)))?(o?(o=!1,a=i&&X.isArray(i)?i:[]):a=i&&X.isPlainObject(i)?i:{},s[n]=X.extend(u,a,r)):r!==t&&(s[n]=r));return s},X.extend({expando:"jQuery"+(V+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===X&&(e.$=D),t&&e.jQuery===X&&(e.jQuery=O),X},isReady:!1,readyWait:1,holdReady:function(e){e?X.readyWait++:X.ready(!0)},ready:function(e){(e===!0?--X.readyWait:X.isReady)||(X.isReady=!0,e!==!0&&--X.readyWait>0||(R.resolveWith(P,[X]),X.fn.trigger&&X(P).trigger("ready").off("ready")))},isFunction:function(e){return"function"===X.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?N[$.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==X.type(e)||e.nodeType||X.isWindow(e))return!1;try{if(e.constructor&&!q.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||P;var i=J.exec(e),r=!n&&[];return i?[t.createElement(i[1])]:(i=X.buildFragment([e],t,r),r&&X(r).remove(),X.merge([],i.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var n,i;if(!e||"string"!=typeof e)return null;try{i=new DOMParser,n=i.parseFromString(e,"text/xml")}catch(r){n=t}return(!n||n.getElementsByTagName("parsererror").length)&&X.error("Invalid XML: "+e),n},noop:function(){},globalEval:function(e){var t,n=eval;e=X.trim(e),e&&(1===e.indexOf("use strict")?(t=P.createElement("script"),t.text=e,P.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(K,"ms-").replace(Q,Z)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var r,o=0,a=e.length,s=n(e);if(i){if(s)for(;a>o&&(r=t.apply(e[o],i),r!==!1);o++);else for(o in e)if(r=t.apply(e[o],i),r===!1)break}else if(s)for(;a>o&&(r=t.call(e[o],o,e[o]),r!==!1);o++);else for(o in e)if(r=t.call(e[o],o,e[o]),r===!1)break;return e},trim:function(e){return null==e?"":B.call(e)},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?X.merge(i,"string"==typeof e?[e]:e):z.call(i,e)),i},inArray:function(e,t,n){return null==t?-1:L.call(t,e,n)},merge:function(e,n){var i=n.length,r=e.length,o=0;if("number"==typeof i)for(;i>o;o++)e[r++]=n[o];else for(;n[o]!==t;)e[r++]=n[o++];return e.length=r,e},grep:function(e,t,n){var i,r=[],o=0,a=e.length;for(n=!!n;a>o;o++)i=!!t(e[o],o),n!==i&&r.push(e[o]);return r},map:function(e,t,i){var r,o=0,a=e.length,s=n(e),l=[];if(s)for(;a>o;o++)r=t(e[o],o,i),null!=r&&(l[l.length]=r);else for(o in e)r=t(e[o],o,i),null!=r&&(l[l.length]=r);return F.apply([],l)},guid:1,proxy:function(e,n){var i,r,o;return"string"==typeof n&&(i=e[n],n=e,e=i),X.isFunction(e)?(r=W.call(arguments,2),o=function(){return e.apply(n||this,r.concat(W.call(arguments)))},o.guid=e.guid=e.guid||X.guid++,o):t},access:function(e,n,i,r,o,a,s){var l=0,c=e.length,u=null==i;if("object"===X.type(i)){o=!0;for(l in i)X.access(e,n,l,i[l],!0,a,s)}else if(r!==t&&(o=!0,X.isFunction(r)||(s=!0),u&&(s?(n.call(e,r),n=null):(u=n,n=function(e,t,n){return u.call(X(e),n)})),n))for(;c>l;l++)n(e[l],i,s?r:r.call(e[l],l,n(e[l],i)));return o?e:u?n.call(e):c?n(e[0],i):a},now:Date.now,swap:function(e,t,n,i){var r,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];r=n.apply(e,i||[]);for(o in t)e.style[o]=a[o];return r}}),X.ready.promise=function(t){return R||(R=X.Deferred(),"complete"===P.readyState?setTimeout(X.ready):(P.addEventListener("DOMContentLoaded",et,!1),e.addEventListener("load",et,!1))),R.promise(t)},X.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){N["[object "+t+"]"]=t.toLowerCase()}),M=X(P);var tt,nt=I.webkitMatchesSelector||I.mozMatchesSelector||I.oMatchesSelector||I.msMatchesSelector,it=function(e,t){if(e===t)return tt=!0,0;var n=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return n?1&n?e===P||X.contains(P,e)?-1:t===P||X.contains(P,t)?1:0:4&n?-1:1:e.compareDocumentPosition?-1:1};X.extend({find:function(e,t,n,i){var r,o,a=0;if(n=n||[],t=t||P,!e||"string"!=typeof e)return n;if(1!==(o=t.nodeType)&&9!==o)return[];if(i)for(;r=i[a++];)X.find.matchesSelector(r,e)&&n.push(r);else X.merge(n,t.querySelectorAll(e));return n},unique:function(e){var t,n=[],i=0,r=0;if(tt=!1,e.sort(it),tt){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return e},text:function(e){var t,n="",i=0,r=e.nodeType;if(r){if(1===r||9===r||11===r)return e.textContent;if(3===r||4===r)return e.nodeValue}else for(;t=e[i++];)n+=X.text(t);return n},contains:function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!n.contains(i))},isXMLDoc:function(e){return"HTML"!==(e.ownerDocument||e).documentElement.nodeName},expr:{attrHandle:{},match:{bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]/}}}),X.extend(X.find,{matches:function(e,t){return X.find(e,null,null,t)},matchesSelector:function(e,t){return nt.call(e,t)},attr:function(e,t){return e.getAttribute(t)}});var rt={};X.Callbacks=function(e){e="string"==typeof e?rt[e]||i(e):X.extend({},e);var n,r,o,a,s,l,c=[],u=!e.once&&[],h=function(t){for(n=e.memory&&t,r=!0,l=a||0,a=0,s=c.length,o=!0;c&&s>l;l++)if(c[l].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}o=!1,c&&(u?u.length&&h(u.shift()):n?c=[]:p.disable())},p={add:function(){if(c){var t=c.length;!function i(t){X.each(t,function(t,n){var r=X.type(n);"function"===r?e.unique&&p.has(n)||c.push(n):n&&n.length&&"string"!==r&&i(n)})}(arguments),o?s=c.length:n&&(a=t,h(n))}return this},remove:function(){return c&&X.each(arguments,function(e,t){for(var n;(n=X.inArray(t,c,n))>-1;)c.splice(n,1),o&&(s>=n&&s--,l>=n&&l--)}),this},has:function(e){return e?X.inArray(e,c)>-1:!(!c||!c.length)},empty:function(){return c=[],s=0,this},disable:function(){return c=u=n=t,this},disabled:function(){return!c},lock:function(){return u=t,n||p.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!c||r&&!u||(t=t||[],t=[e,t.slice?t.slice():t],o?u.push(t):h(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!r}};return p},X.extend({Deferred:function(e){var t=[["resolve","done",X.Callbacks("once memory"),"resolved"],["reject","fail",X.Callbacks("once memory"),"rejected"],["notify","progress",X.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return X.Deferred(function(n){X.each(t,function(t,o){var a=o[0],s=X.isFunction(e[t])&&e[t];r[o[1]](function(){var e=s&&s.apply(this,arguments);e&&X.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===i?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?X.extend(e,i):i}},r={};return i.pipe=i.then,X.each(t,function(e,o){var a=o[2],s=o[3];i[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=a.fireWith}),i.promise(r),e&&e.call(r,r),r},when:function(e){var t,n,i,r=0,o=W.call(arguments),a=o.length,s=1!==a||e&&X.isFunction(e.promise)?a:0,l=1===s?e:X.Deferred(),c=function(e,n,i){return function(r){n[e]=this,i[e]=arguments.length>1?W.call(arguments):r,i===t?l.notifyWith(n,i):--s||l.resolveWith(n,i)}};if(a>1)for(t=Array(a),n=Array(a),i=Array(a);a>r;r++)o[r]&&X.isFunction(o[r].promise)?o[r].promise().done(c(r,i,o)).fail(l.reject).progress(c(r,n,t)):--s;return s||l.resolveWith(i,o),l.promise()}}),X.support=function(t){var n=P.createElement("input"),i=P.createDocumentFragment(),r=P.createElement("div"),o=P.createElement("select"),a=o.appendChild(P.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=a.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!a.disabled,n=P.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),i.appendChild(n),t.checkClone=i.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===r.style.backgroundClip,X(function(){var n,i,o="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",a=P.getElementsByTagName("body")[0];a&&(n=P.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(r),r.innerHTML="",r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",X.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===r.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(r,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(r,null)||{width:"4px"}).width,i=r.appendChild(P.createElement("div")),i.style.cssText=r.style.cssText=o,i.style.marginRight=i.style.width="0",r.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(i,null)||{}).marginRight)),a.removeChild(n))}),t):t}({});var ot,at,st=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,lt=/([A-Z])/g;r.uid=1,r.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},r.prototype={key:function(e){if(!r.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=r.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(i){t[this.expando]=n,X.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var i,r=this.key(e),o=this.cache[r];if("string"==typeof t)o[t]=n;else if(X.isEmptyObject(o))X.extend(this.cache[r],t);else for(i in t)o[i]=t[i];return o},get:function(e,n){var i=this.cache[this.key(e)];return n===t?i:i[n]},access:function(e,n,i){var r;return n===t||n&&"string"==typeof n&&i===t?(r=this.get(e,n),r!==t?r:this.get(e,X.camelCase(n))):(this.set(e,n,i),i!==t?i:n)},remove:function(e,n){var i,r,o,a=this.key(e),s=this.cache[a];if(n===t)this.cache[a]={};else{X.isArray(n)?r=n.concat(n.map(X.camelCase)):(o=X.camelCase(n),n in s?r=[n,o]:(r=o,r=r in s?[r]:r.match(Y)||[])),i=r.length;for(;i--;)delete s[r[i]]}},hasData:function(e){return!X.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},ot=new r,at=new r,X.extend({acceptData:r.accepts,hasData:function(e){return ot.hasData(e)||at.hasData(e)},data:function(e,t,n){return ot.access(e,t,n)},removeData:function(e,t){ot.remove(e,t)},_data:function(e,t,n){return at.access(e,t,n)},_removeData:function(e,t){at.remove(e,t)}}),X.fn.extend({data:function(e,n){var i,r,a=this[0],s=0,l=null;if(e===t){if(this.length&&(l=ot.get(a),1===a.nodeType&&!at.get(a,"hasDataAttrs"))){for(i=a.attributes;i.length>s;s++)r=i[s].name,0===r.indexOf("data-")&&(r=X.camelCase(r.slice(5)),o(a,r,l[r]));at.set(a,"hasDataAttrs",!0)}return l}return"object"==typeof e?this.each(function(){ot.set(this,e)}):X.access(this,function(n){var i,r=X.camelCase(e);if(a&&n===t){if(i=ot.get(a,e),i!==t)return i;if(i=ot.get(a,r),i!==t)return i;if(i=o(a,r,t),i!==t)return i}else this.each(function(){var i=ot.get(this,r);ot.set(this,r,n),-1!==e.indexOf("-")&&i!==t&&ot.set(this,e,n)})},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){ot.remove(this,e)})}}),X.extend({queue:function(e,n,i){var r;return e?(n=(n||"fx")+"queue",r=at.get(e,n),i&&(!r||X.isArray(i)?r=at.access(e,n,X.makeArray(i)):r.push(i)),r||[]):t},dequeue:function(e,t){t=t||"fx";var n=X.queue(e,t),i=n.length,r=n.shift(),o=X._queueHooks(e,t),a=function(){X.dequeue(e,t)};"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,a,o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return at.get(e,n)||at.access(e,n,{empty:X.Callbacks("once memory").add(function(){at.remove(e,[t+"queue",n])})})}}),X.fn.extend({queue:function(e,n){var i=2;return"string"!=typeof e&&(n=e,e="fx",i--),i>arguments.length?X.queue(this[0],e):n===t?this:this.each(function(){var t=X.queue(this,e,n);X._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&X.dequeue(this,e)})},dequeue:function(e){return this.each(function(){X.dequeue(this,e)})},delay:function(e,t){return e=X.fx?X.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var i,r=1,o=X.Deferred(),a=this,s=this.length,l=function(){--r||o.resolveWith(a,[a])};for("string"!=typeof e&&(n=e,e=t),e=e||"fx";s--;)i=at.get(a[s],e+"queueHooks"),i&&i.empty&&(r++,i.empty.add(l));return l(),o.promise(n)}});var ct,ut,ht=/[\t\r\n\f]/g,pt=/\r/g,ft=/^(?:input|select|textarea|button)$/i;X.fn.extend({attr:function(e,t){return X.access(this,X.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){X.removeAttr(this,e)})},prop:function(e,t){return X.access(this,X.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[X.propFix[e]||e]})},addClass:function(e){var t,n,i,r,o,a=0,s=this.length,l="string"==typeof e&&e;if(X.isFunction(e))return this.each(function(t){X(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(Y)||[];s>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ht," "):" ")){for(o=0;r=t[o++];)0>i.indexOf(" "+r+" ")&&(i+=r+" ");n.className=X.trim(i)}return this},removeClass:function(e){var t,n,i,r,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;if(X.isFunction(e))return this.each(function(t){X(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(Y)||[];s>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ht," "):"")){for(o=0;r=t[o++];)for(;i.indexOf(" "+r+" ")>=0;)i=i.replace(" "+r+" "," ");n.className=e?X.trim(i):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):X.isFunction(e)?this.each(function(n){X(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var t,i=0,r=X(this),o=e.match(Y)||[];t=o[i++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else(n===A||"boolean"===n)&&(this.className&&at.set(this,"__className__",this.className),this.className=this.className||e===!1?"":at.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(ht," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,i,r,o=this[0];return arguments.length?(r=X.isFunction(e),this.each(function(i){var o;1===this.nodeType&&(o=r?e.call(this,i,X(this).val()):e,null==o?o="":"number"==typeof o?o+="":X.isArray(o)&&(o=X.map(o,function(e){return null==e?"":e+""})),n=X.valHooks[this.type]||X.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,o,"value")!==t||(this.value=o))})):o?(n=X.valHooks[o.type]||X.valHooks[o.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(o,"value"))!==t?i:(i=o.value,"string"==typeof i?i.replace(pt,""):null==i?"":i)):void 0
}}),X.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,n,i=e.options,r=e.selectedIndex,o="select-one"===e.type||0>r,a=o?null:[],s=o?r+1:i.length,l=0>r?s:o?r:0;s>l;l++)if(n=i[l],!(!n.selected&&l!==r||(X.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&X.nodeName(n.parentNode,"optgroup"))){if(t=X(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,i,r=e.options,o=X.makeArray(t),a=r.length;a--;)i=r[a],(i.selected=X.inArray(X(i).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,n,i){var r,o,a=e.nodeType;return e&&3!==a&&8!==a&&2!==a?typeof e.getAttribute===A?X.prop(e,n,i):(1===a&&X.isXMLDoc(e)||(n=n.toLowerCase(),r=X.attrHooks[n]||(X.expr.match.bool.test(n)?ut:ct)),i===t?r&&"get"in r&&null!==(o=r.get(e,n))?o:(o=X.find.attr(e,n),null==o?t:o):null!==i?r&&"set"in r&&(o=r.set(e,i,n))!==t?o:(e.setAttribute(n,i+""),i):(X.removeAttr(e,n),t)):void 0},removeAttr:function(e,t){var n,i,r=0,o=t&&t.match(Y);if(o&&1===e.nodeType)for(;n=o[r++];)i=X.propFix[n]||n,X.expr.match.bool.test(n)&&(e[i]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!X.support.radioValue&&"radio"===t&&X.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,i){var r,o,a,s=e.nodeType;return e&&3!==s&&8!==s&&2!==s?(a=1!==s||!X.isXMLDoc(e),a&&(n=X.propFix[n]||n,o=X.propHooks[n]),i!==t?o&&"set"in o&&(r=o.set(e,i,n))!==t?r:e[n]=i:o&&"get"in o&&null!==(r=o.get(e,n))?r:e[n]):void 0},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||ft.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),ut={set:function(e,t,n){return t===!1?X.removeAttr(e,n):e.setAttribute(n,n),n}},X.each(X.expr.match.bool.source.match(/\w+/g),function(e,n){var i=X.expr.attrHandle[n]||X.find.attr;X.expr.attrHandle[n]=function(e,n,r){var o=X.expr.attrHandle[n],a=r?t:(X.expr.attrHandle[n]=t)!=i(e,n,r)?n.toLowerCase():null;return X.expr.attrHandle[n]=o,a}}),X.support.optSelected||(X.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),X.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){X.propFix[this.toLowerCase()]=this}),X.each(["radio","checkbox"],function(){X.valHooks[this]={set:function(e,n){return X.isArray(n)?e.checked=X.inArray(X(e).val(),n)>=0:t}},X.support.checkOn||(X.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var dt=/^key/,gt=/^(?:mouse|contextmenu)|click/,mt=/^(?:focusinfocus|focusoutblur)$/,vt=/^([^.]*)(?:\.(.+)|)$/;X.event={global:{},add:function(e,n,i,r,o){var a,s,l,c,u,h,p,f,d,g,m,v=at.get(e);if(v){for(i.handler&&(a=i,i=a.handler,o=a.selector),i.guid||(i.guid=X.guid++),(c=v.events)||(c=v.events={}),(s=v.handle)||(s=v.handle=function(e){return typeof X===A||e&&X.event.triggered===e.type?t:X.event.dispatch.apply(s.elem,arguments)},s.elem=e),n=(n||"").match(Y)||[""],u=n.length;u--;)l=vt.exec(n[u])||[],d=m=l[1],g=(l[2]||"").split(".").sort(),d&&(p=X.event.special[d]||{},d=(o?p.delegateType:p.bindType)||d,p=X.event.special[d]||{},h=X.extend({type:d,origType:m,data:r,handler:i,guid:i.guid,selector:o,needsContext:o&&X.expr.match.needsContext.test(o),namespace:g.join(".")},a),(f=c[d])||(f=c[d]=[],f.delegateCount=0,p.setup&&p.setup.call(e,r,g,s)!==!1||e.addEventListener&&e.addEventListener(d,s,!1)),p.add&&(p.add.call(e,h),h.handler.guid||(h.handler.guid=i.guid)),o?f.splice(f.delegateCount++,0,h):f.push(h),X.event.global[d]=!0);e=null}},remove:function(e,t,n,i,r){var o,a,s,l,c,u,h,p,f,d,g,m=at.hasData(e)&&at.get(e);if(m&&(l=m.events)){for(t=(t||"").match(Y)||[""],c=t.length;c--;)if(s=vt.exec(t[c])||[],f=g=s[1],d=(s[2]||"").split(".").sort(),f){for(h=X.event.special[f]||{},f=(i?h.delegateType:h.bindType)||f,p=l[f]||[],s=s[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;o--;)u=p[o],!r&&g!==u.origType||n&&n.guid!==u.guid||s&&!s.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(p.splice(o,1),u.selector&&p.delegateCount--,h.remove&&h.remove.call(e,u));a&&!p.length&&(h.teardown&&h.teardown.call(e,d,m.handle)!==!1||X.removeEvent(e,f,m.handle),delete l[f])}else for(f in l)X.event.remove(e,f+t[c],n,i,!0);X.isEmptyObject(l)&&(delete m.handle,at.remove(e,"events"))}},trigger:function(n,i,r,o){var a,s,l,c,u,h,p,f=[r||P],d=q.call(n,"type")?n.type:n,g=q.call(n,"namespace")?n.namespace.split("."):[];if(s=l=r=r||P,3!==r.nodeType&&8!==r.nodeType&&!mt.test(d+X.event.triggered)&&(d.indexOf(".")>=0&&(g=d.split("."),d=g.shift(),g.sort()),u=0>d.indexOf(":")&&"on"+d,n=n[X.expando]?n:new X.Event(d,"object"==typeof n&&n),n.isTrigger=o?2:3,n.namespace=g.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=r),i=null==i?[n]:X.makeArray(i,[n]),p=X.event.special[d]||{},o||!p.trigger||p.trigger.apply(r,i)!==!1)){if(!o&&!p.noBubble&&!X.isWindow(r)){for(c=p.delegateType||d,mt.test(c+d)||(s=s.parentNode);s;s=s.parentNode)f.push(s),l=s;l===(r.ownerDocument||P)&&f.push(l.defaultView||l.parentWindow||e)}for(a=0;(s=f[a++])&&!n.isPropagationStopped();)n.type=a>1?c:p.bindType||d,h=(at.get(s,"events")||{})[n.type]&&at.get(s,"handle"),h&&h.apply(s,i),h=u&&s[u],h&&X.acceptData(s)&&h.apply&&h.apply(s,i)===!1&&n.preventDefault();return n.type=d,o||n.isDefaultPrevented()||p._default&&p._default.apply(f.pop(),i)!==!1||!X.acceptData(r)||u&&X.isFunction(r[d])&&!X.isWindow(r)&&(l=r[u],l&&(r[u]=null),X.event.triggered=d,r[d](),X.event.triggered=t,l&&(r[u]=l)),n.result}},dispatch:function(e){e=X.event.fix(e);var n,i,r,o,a,s=[],l=W.call(arguments),c=(at.get(this,"events")||{})[e.type]||[],u=X.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,e)!==!1){for(s=X.event.handlers.call(this,e,c),n=0;(o=s[n++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,i=0;(a=o.handlers[i++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(a.namespace))&&(e.handleObj=a,e.data=a.data,r=((X.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,l),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,n){var i,r,o,a,s=[],l=n.delegateCount,c=e.target;if(l&&c.nodeType&&(!e.button||"click"!==e.type))for(;c!==this;c=c.parentNode||this)if(c.disabled!==!0||"click"!==e.type){for(r=[],i=0;l>i;i++)a=n[i],o=a.selector+" ",r[o]===t&&(r[o]=a.needsContext?X(o,this).index(c)>=0:X.find(o,this,null,[c]).length),r[o]&&r.push(a);r.length&&s.push({elem:c,handlers:r})}return n.length>l&&s.push({elem:this,handlers:n.slice(l)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var i,r,o,a=n.button;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||P,r=i.documentElement,o=i.body,e.pageX=n.clientX+(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r&&r.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(r&&r.scrollTop||o&&o.scrollTop||0)-(r&&r.clientTop||o&&o.clientTop||0)),e.which||a===t||(e.which=1&a?1:2&a?3:4&a?2:0),e}},fix:function(e){if(e[X.expando])return e;var t,n,i,r=e.type,o=e,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=gt.test(r)?this.mouseHooks:dt.test(r)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new X.Event(o),t=i.length;t--;)n=i[t],e[n]=o[n];return e.target||(e.target=P),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==l()&&this.focus?(this.focus(),!1):t},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&X.nodeName(this,"input")?(this.click(),!1):t},_default:function(e){return X.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var r=X.extend(new X.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?X.event.trigger(r,null,t):X.event.dispatch.call(t,r),r.isDefaultPrevented()&&n.preventDefault()}},X.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},X.Event=function(e,n){return this instanceof X.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?a:s):this.type=e,n&&X.extend(this,n),this.timeStamp=e&&e.timeStamp||X.now(),this[X.expando]=!0,t):new X.Event(e,n)},X.Event.prototype={isDefaultPrevented:s,isPropagationStopped:s,isImmediatePropagationStopped:s,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=a,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=a,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()}},X.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){X.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,r=e.relatedTarget,o=e.handleObj;return(!r||r!==i&&!X.contains(i,r))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),X.support.focusinBubbles||X.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,i=function(e){X.event.simulate(t,e.target,X.event.fix(e),!0)};X.event.special[t]={setup:function(){0===n++&&P.addEventListener(e,i,!0)},teardown:function(){0===--n&&P.removeEventListener(e,i,!0)}}}),X.fn.extend({on:function(e,n,i,r,o){var a,l;if("object"==typeof e){"string"!=typeof n&&(i=i||n,n=t);for(l in e)this.on(l,n,i,e[l],o);return this}if(null==i&&null==r?(r=n,i=n=t):null==r&&("string"==typeof n?(r=i,i=t):(r=i,i=n,n=t)),r===!1)r=s;else if(!r)return this;return 1===o&&(a=r,r=function(e){return X().off(e),a.apply(this,arguments)},r.guid=a.guid||(a.guid=X.guid++)),this.each(function(){X.event.add(this,e,r,i,n)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,n,i){var r,o;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,X(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(i=n,n=t),i===!1&&(i=s),this.each(function(){X.event.remove(this,e,i,n)})},trigger:function(e,t){return this.each(function(){X.event.trigger(e,t,this)})},triggerHandler:function(e,n){var i=this[0];return i?X.event.trigger(e,n,i,!0):t}});var yt=/^.[^:#\[\.,]*$/,bt=/^(?:parents|prev(?:Until|All))/,wt=X.expr.match.needsContext,xt={children:!0,contents:!0,next:!0,prev:!0};X.fn.extend({find:function(e){var t,n=[],i=this,r=i.length;if("string"!=typeof e)return this.pushStack(X(e).filter(function(){for(t=0;r>t;t++)if(X.contains(i[t],this))return!0}));for(t=0;r>t;t++)X.find(e,i[t],n);return n=this.pushStack(r>1?X.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=X(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(X.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(u(this,e||[],!0))},filter:function(e){return this.pushStack(u(this,e||[],!1))},is:function(e){return!!u(this,"string"==typeof e&&wt.test(e)?X(e):e||[],!1).length},closest:function(e,t){for(var n,i=0,r=this.length,o=[],a=wt.test(e)||"string"!=typeof e?X(e,t||this.context):0;r>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(a?a.index(n)>-1:1===n.nodeType&&X.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?X.unique(o):o)},index:function(e){return e?"string"==typeof e?L.call(X(e),this[0]):L.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?X(e,t):X.makeArray(e&&e.nodeType?[e]:e),i=X.merge(this.get(),n);return this.pushStack(X.unique(i))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),X.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return X.dir(e,"parentNode")},parentsUntil:function(e,t,n){return X.dir(e,"parentNode",n)},next:function(e){return c(e,"nextSibling")},prev:function(e){return c(e,"previousSibling")},nextAll:function(e){return X.dir(e,"nextSibling")},prevAll:function(e){return X.dir(e,"previousSibling")},nextUntil:function(e,t,n){return X.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return X.dir(e,"previousSibling",n)},siblings:function(e){return X.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return X.sibling(e.firstChild)},contents:function(e){return e.contentDocument||X.merge([],e.childNodes)}},function(e,t){X.fn[e]=function(n,i){var r=X.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=X.filter(i,r)),this.length>1&&(xt[e]||X.unique(r),bt.test(e)&&r.reverse()),this.pushStack(r)}}),X.extend({filter:function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?X.find.matchesSelector(i,e)?[i]:[]:X.find.matches(e,X.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,i){for(var r=[],o=i!==t;(e=e[n])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&X(e).is(i))break;r.push(e)}return r},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var _t=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ct=/<([\w:]+)/,kt=/<|&#?\w+;/,St=/<(?:script|style|link)/i,Et=/^(?:checkbox|radio)$/i,Tt=/checked\s*(?:[^=]|=\s*.checked.)/i,Ht=/^$|\/(?:java|ecma)script/i,Mt=/^true\/(.*)/,Rt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,At={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,X.fn.extend({text:function(e){return X.access(this,function(e){return e===t?X.text(this):this.empty().append((this[0]&&this[0].ownerDocument||P).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=h(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=h(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?X.filter(e,this):this,r=0;null!=(n=i[r]);r++)t||1!==n.nodeType||X.cleanData(m(n)),n.parentNode&&(t&&X.contains(n.ownerDocument,n)&&d(m(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(X.cleanData(m(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return X.clone(this,e,t)})},html:function(e){return X.access(this,function(e){var n=this[0]||{},i=0,r=this.length;if(e===t&&1===n.nodeType)return n.innerHTML;if("string"==typeof e&&!St.test(e)&&!At[(Ct.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(_t,"<$1></$2>");try{for(;r>i;i++)n=this[i]||{},1===n.nodeType&&(X.cleanData(m(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=X.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var i=e[t++],r=e[t++];r&&(i&&i.parentNode!==r&&(i=this.nextSibling),X(this).remove(),r.insertBefore(n,i))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=F.apply([],e);var i,r,o,a,s,l,c=0,u=this.length,h=this,d=u-1,g=e[0],v=X.isFunction(g);if(v||!(1>=u||"string"!=typeof g||X.support.checkClone)&&Tt.test(g))return this.each(function(i){var r=h.eq(i);v&&(e[0]=g.call(this,i,r.html())),r.domManip(e,t,n)});if(u&&(i=X.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=i.firstChild,1===i.childNodes.length&&(i=r),r)){for(o=X.map(m(i,"script"),p),a=o.length;u>c;c++)s=i,c!==d&&(s=X.clone(s,!0,!0),a&&X.merge(o,m(s,"script"))),t.call(this[c],s,c);if(a)for(l=o[o.length-1].ownerDocument,X.map(o,f),c=0;a>c;c++)s=o[c],Ht.test(s.type||"")&&!at.access(s,"globalEval")&&X.contains(l,s)&&(s.src?X._evalUrl(s.src):X.globalEval(s.textContent.replace(Rt,"")))}return this}}),X.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){X.fn[e]=function(e){for(var n,i=[],r=X(e),o=r.length-1,a=0;o>=a;a++)n=a===o?this:this.clone(!0),X(r[a])[t](n),z.apply(i,n.get());return this.pushStack(i)}}),X.extend({clone:function(e,t,n){var i,r,o,a,s=e.cloneNode(!0),l=X.contains(e.ownerDocument,e);if(!(X.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||X.isXMLDoc(e)))for(a=m(s),o=m(e),i=0,r=o.length;r>i;i++)v(o[i],a[i]);if(t)if(n)for(o=o||m(e),a=a||m(s),i=0,r=o.length;r>i;i++)g(o[i],a[i]);else g(e,s);return a=m(s,"script"),a.length>0&&d(a,!l&&m(e,"script")),s},buildFragment:function(e,t,n,i){for(var r,o,a,s,l,c,u=0,h=e.length,p=t.createDocumentFragment(),f=[];h>u;u++)if(r=e[u],r||0===r)if("object"===X.type(r))X.merge(f,r.nodeType?[r]:r);else if(kt.test(r)){for(o=o||p.appendChild(t.createElement("div")),a=(Ct.exec(r)||["",""])[1].toLowerCase(),s=At[a]||At._default,o.innerHTML=s[1]+r.replace(_t,"<$1></$2>")+s[2],c=s[0];c--;)o=o.lastChild;X.merge(f,o.childNodes),o=p.firstChild,o.textContent=""}else f.push(t.createTextNode(r));for(p.textContent="",u=0;r=f[u++];)if((!i||-1===X.inArray(r,i))&&(l=X.contains(r.ownerDocument,r),o=m(p.appendChild(r),"script"),l&&d(o),n))for(c=0;r=o[c++];)Ht.test(r.type||"")&&n.push(r);return p},cleanData:function(e){for(var n,i,o,a,s,l,c=X.event.special,u=0;(i=e[u])!==t;u++){if(r.accepts(i)&&(s=i[at.expando],s&&(n=at.cache[s]))){if(o=Object.keys(n.events||{}),o.length)for(l=0;(a=o[l])!==t;l++)c[a]?X.event.remove(i,a):X.removeEvent(i,a,n.handle);at.cache[s]&&delete at.cache[s]}delete ot.cache[i[ot.expando]]}},_evalUrl:function(e){return X.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}});var Pt,It,Ot=/^(none|table(?!-c[ea]).+)/,Dt=/^margin/,Nt=RegExp("^("+U+")(.*)$","i"),jt=RegExp("^("+U+")(?!px)[a-z%]+$","i"),Vt=RegExp("^([+-])=("+U+")","i"),Ft={BODY:"block"},zt={position:"absolute",visibility:"hidden",display:"block"},Wt={letterSpacing:0,fontWeight:400},Lt=["Top","Right","Bottom","Left"],$t=["Webkit","O","Moz","ms"];X.fn.extend({css:function(e,n){return X.access(this,function(e,n,i){var r,o,a={},s=0;if(X.isArray(n)){for(r=w(e),o=n.length;o>s;s++)a[n[s]]=X.css(e,n[s],!1,r);return a}return i!==t?X.style(e,n,i):X.css(e,n)},e,n,arguments.length>1)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){b(this)?X(this).show():X(this).hide()})}}),X.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Pt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,n,i,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=X.camelCase(n),c=e.style;return n=X.cssProps[l]||(X.cssProps[l]=y(c,l)),s=X.cssHooks[n]||X.cssHooks[l],i===t?s&&"get"in s&&(o=s.get(e,!1,r))!==t?o:c[n]:(a=typeof i,"string"===a&&(o=Vt.exec(i))&&(i=(o[1]+1)*o[2]+parseFloat(X.css(e,n)),a="number"),null==i||"number"===a&&isNaN(i)||("number"!==a||X.cssNumber[l]||(i+="px"),X.support.clearCloneStyle||""!==i||0!==n.indexOf("background")||(c[n]="inherit"),s&&"set"in s&&(i=s.set(e,i,r))===t||(c[n]=i)),t)}},css:function(e,n,i,r){var o,a,s,l=X.camelCase(n);return n=X.cssProps[l]||(X.cssProps[l]=y(e.style,l)),s=X.cssHooks[n]||X.cssHooks[l],s&&"get"in s&&(o=s.get(e,!0,i)),o===t&&(o=Pt(e,n,r)),"normal"===o&&n in Wt&&(o=Wt[n]),""===i||i?(a=parseFloat(o),i===!0||X.isNumeric(a)?a||0:o):o}}),Pt=function(e,n,i){var r,o,a,s=i||w(e),l=s?s.getPropertyValue(n)||s[n]:t,c=e.style;return s&&(""!==l||X.contains(e.ownerDocument,e)||(l=X.style(e,n)),jt.test(l)&&Dt.test(n)&&(r=c.width,o=c.minWidth,a=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=s.width,c.width=r,c.minWidth=o,c.maxWidth=a)),l},X.each(["height","width"],function(e,n){X.cssHooks[n]={get:function(e,i,r){return i?0===e.offsetWidth&&Ot.test(X.css(e,"display"))?X.swap(e,zt,function(){return k(e,n,r)}):k(e,n,r):t},set:function(e,t,i){var r=i&&w(e);return _(e,t,i?C(e,n,i,X.support.boxSizing&&"border-box"===X.css(e,"boxSizing",!1,r),r):0)}}}),X(function(){X.support.reliableMarginRight||(X.cssHooks.marginRight={get:function(e,n){return n?X.swap(e,{display:"inline-block"},Pt,[e,"marginRight"]):t}}),!X.support.pixelPosition&&X.fn.position&&X.each(["top","left"],function(e,n){X.cssHooks[n]={get:function(e,i){return i?(i=Pt(e,n),jt.test(i)?X(e).position()[n]+"px":i):t}}})}),X.expr&&X.expr.filters&&(X.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},X.expr.filters.visible=function(e){return!X.expr.filters.hidden(e)}),X.each({margin:"",padding:"",border:"Width"},function(e,t){X.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];4>i;i++)r[e+Lt[i]+t]=o[i]||o[i-2]||o[0];return r}},Dt.test(e)||(X.cssHooks[e+t].set=_)});var qt=/%20/g,Bt=/\[\]$/,Xt=/\r?\n/g,Ut=/^(?:submit|button|image|reset|file)$/i,Yt=/^(?:input|select|textarea|keygen)/i;X.fn.extend({serialize:function(){return X.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=X.prop(this,"elements");return e?X.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!X(this).is(":disabled")&&Yt.test(this.nodeName)&&!Ut.test(e)&&(this.checked||!Et.test(e))}).map(function(e,t){var n=X(this).val();return null==n?null:X.isArray(n)?X.map(n,function(e){return{name:t.name,value:e.replace(Xt,"\r\n")}}):{name:t.name,value:n.replace(Xt,"\r\n")}}).get()}}),X.param=function(e,n){var i,r=[],o=function(e,t){t=X.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=X.ajaxSettings&&X.ajaxSettings.traditional),X.isArray(e)||e.jquery&&!X.isPlainObject(e))X.each(e,function(){o(this.name,this.value)});else for(i in e)T(i,e[i],n,o);return r.join("&").replace(qt,"+")},X.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){X.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),X.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),X.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){X.offset.setOffset(this,e,t)});var n,i,r=this[0],o={top:0,left:0},a=r&&r.ownerDocument;return a?(n=a.documentElement,X.contains(n,r)?(typeof r.getBoundingClientRect!==A&&(o=r.getBoundingClientRect()),i=H(a),{top:o.top+i.pageYOffset-n.clientTop,left:o.left+i.pageXOffset-n.clientLeft}):o):void 0},X.offset={setOffset:function(e,t,n){var i,r,o,a,s,l,c,u=X.css(e,"position"),h=X(e),p={};"static"===u&&(e.style.position="relative"),s=h.offset(),o=X.css(e,"top"),l=X.css(e,"left"),c=("absolute"===u||"fixed"===u)&&(o+l).indexOf("auto")>-1,c?(i=h.position(),a=i.top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(l)||0),X.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+r),"using"in t?t.using.call(e,p):h.css(p)}},X.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],i={top:0,left:0};return"fixed"===X.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),X.nodeName(e[0],"html")||(i=e.offset()),i.top+=X.css(e[0],"borderTopWidth",!0),i.left+=X.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-X.css(n,"marginTop",!0),left:t.left-i.left-X.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||I;e&&!X.nodeName(e,"html")&&"static"===X.css(e,"position");)e=e.offsetParent;return e||I})}}),X.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(n,i){var r="pageYOffset"===i;X.fn[n]=function(o){return X.access(this,function(n,o,a){var s=H(n);return a===t?s?s[i]:n[o]:(s?s.scrollTo(r?e.pageXOffset:a,r?a:e.pageYOffset):n[o]=a,t)},n,o,arguments.length,null)}}),X.each({Height:"height",Width:"width"},function(e,n){X.each({padding:"inner"+e,content:n,"":"outer"+e},function(i,r){X.fn[r]=function(r,o){var a=arguments.length&&(i||"boolean"!=typeof r),s=i||(r===!0||o===!0?"margin":"border");return X.access(this,function(n,i,r){var o;return X.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):r===t?X.css(n,i,s):X.style(n,i,r,s)},n,a?r:t,a,null)}})}),"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=X:"function"==typeof define&&define.amd&&define("jquery",[],function(){return X}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=X)}(window),function(){var e,t=this,n=t.Backbone,i=[],r=i.push,o=i.slice,a=i.splice;e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="1.0.0";var s=t._;s||"undefined"==typeof require||(s=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender||t.$,e.noConflict=function(){return t.Backbone=n,this},e.emulateHTTP=!1,e.emulateJSON=!1;var l=e.Events={on:function(e,t,n){if(!u(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!u(this,"once",e,[t,n])||!t)return this;var i=this,r=s.once(function(){i.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,n)},off:function(e,t,n){var i,r,o,a,l,c,h,p;if(!this._events||!u(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(a=e?[e]:s.keys(this._events),l=0,c=a.length;c>l;l++)if(e=a[l],o=this._events[e]){if(this._events[e]=i=[],t||n)for(h=0,p=o.length;p>h;h++)r=o[h],(t&&t!==r.callback&&t!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!u(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&h(n,t),i&&h(i,arguments),this},stopListening:function(e,t,n){var i=this._listeners;if(!i)return this;var r=!t&&!n;"object"==typeof t&&(n=this),e&&((i={})[e._listenerId]=e);for(var o in i)i[o].off(t,n,this),r&&delete this._listeners[o];return this}},c=/\s+/,u=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)e[t].apply(e,[r,n[r]].concat(i));return!1}if(c.test(n)){for(var o=n.split(c),a=0,s=o.length;s>a;a++)e[t].apply(e,[o[a]].concat(i));return!1}return!0},h=function(e,t){var n,i=-1,r=e.length,o=t[0],a=t[1],s=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,a);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,a,s);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t)}},p={listenTo:"on",listenToOnce:"once"};s.each(p,function(e,t){l[t]=function(t,n,i){var r=this._listeners||(this._listeners={}),o=t._listenerId||(t._listenerId=s.uniqueId("l"));return r[o]=t,"object"==typeof n&&(i=this),t[e](n,i,this),this}}),l.bind=l.on,l.unbind=l.off,s.extend(e,l);var f=e.Model=function(e,t){var n,i=e||{};t||(t={}),this.cid=s.uniqueId("c"),this.attributes={},s.extend(this,s.pick(t,d)),t.parse&&(i=this.parse(i,t)||{}),(n=s.result(this,"defaults"))&&(i=s.defaults({},i,n)),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)},d=["url","urlRoot","collection"];s.extend(f.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return s.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return s.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var i,r,o,a,l,c,u,h;if(null==e)return this;if("object"==typeof e?(r=e,n=t):(r={})[e]=t,n||(n={}),!this._validate(r,n))return!1;o=n.unset,l=n.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=s.clone(this.attributes),this.changed={}),h=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(i in r)t=r[i],s.isEqual(h[i],t)||a.push(i),s.isEqual(u[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete h[i]:h[i]=t;if(!l){a.length&&(this._pending=!0);for(var p=0,f=a.length;f>p;p++)this.trigger("change:"+a[p],this,h[a[p]],n)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,s.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,s.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!s.isEmpty(this.changed):s.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var r in e)s.isEqual(i[r],t=e[r])||((n||(n={}))[r]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){return t.set(t.parse(i,e),e)?(n&&n(t,i,e),t.trigger("sync",t,i,e),void 0):!1},j(this,e),this.sync("read",this,e)},save:function(e,t,n){var i,r,o,a=this.attributes;if(null==e||"object"==typeof e?(i=e,n=t):(i={})[e]=t,!(!i||n&&n.wait||this.set(i,n)))return!1;if(n=s.extend({validate:!0},n),!this._validate(i,n))return!1;i&&n.wait&&(this.attributes=s.extend({},a,i)),void 0===n.parse&&(n.parse=!0);var l=this,c=n.success;return n.success=function(e){l.attributes=a;var t=l.parse(e,n);return n.wait&&(t=s.extend(i||{},t)),s.isObject(t)&&!l.set(t,n)?!1:(c&&c(l,e,n),l.trigger("sync",l,e,n),void 0)},j(this,n),r=this.isNew()?"create":n.patch?"patch":"update","patch"===r&&(n.attrs=i),o=this.sync(r,this,n),i&&n.wait&&(this.attributes=a),o},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(r){(e.wait||t.isNew())&&i(),n&&n(t,r,e),t.isNew()||t.trigger("sync",t,r,e)},this.isNew())return e.success(),!1;j(this,e);var r=this.sync("delete",this,e);return e.wait||i(),r},url:function(){var e=s.result(this,"urlRoot")||s.result(this.collection,"url")||N();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)
},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},s.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,s.extend(t||{},{validationError:n})),!1):!0}});var g=["keys","values","pairs","invert","pick","omit"];s.each(g,function(e){f.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),s[e].apply(s,t)}});var m=e.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,s.extend({silent:!0},t))},v={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};s.extend(m.prototype,l,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){return this.set(e,s.defaults(t||{},y))},remove:function(e,t){e=s.isArray(e)?e.slice():[e],t||(t={});var n,i,r,o;for(n=0,i=e.length;i>n;n++)o=this.get(e[n]),o&&(delete this._byId[o.id],delete this._byId[o.cid],r=this.indexOf(o),this.models.splice(r,1),this.length--,t.silent||(t.index=r,o.trigger("remove",o,this,t)),this._removeReference(o));return this},set:function(e,t){t=s.defaults(t||{},v),t.parse&&(e=this.parse(e,t)),s.isArray(e)||(e=e?[e]:[]);var n,i,o,l,c,u=t.at,h=this.comparator&&null==u&&t.sort!==!1,p=s.isString(this.comparator)?this.comparator:null,f=[],d=[],g={};for(n=0,i=e.length;i>n;n++)(o=this._prepareModel(e[n],t))&&((l=this.get(o))?(t.remove&&(g[l.cid]=!0),t.merge&&(l.set(o.attributes,t),h&&!c&&l.hasChanged(p)&&(c=!0))):t.add&&(f.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)));if(t.remove){for(n=0,i=this.length;i>n;++n)g[(o=this.models[n]).cid]||d.push(o);d.length&&this.remove(d,t)}if(f.length&&(h&&(c=!0),this.length+=f.length,null!=u?a.apply(this.models,[u,0].concat(f)):r.apply(this.models,f)),c&&this.sort({silent:!0}),t.silent)return this;for(n=0,i=f.length;i>n;n++)(o=f[n]).trigger("add",o,this,t);return c&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return null==e?void 0:this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return s.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var i=s.isFunction(t)?t:function(e){return e.get(t)};return s.sortedIndex(this.models,e,i,n)},pluck:function(e){return s.invoke(this.models,"get",e)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var r=e.reset?"reset":"set";n[r](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},j(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?s.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,i=t.success;return t.success=function(r){t.wait&&n.add(e,t),i&&i(e,r,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof f)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];s.each(b,function(e){m.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),s[e].apply(s,t)}});var w=["groupBy","countBy","sortBy"];s.each(w,function(e){m.prototype[e]=function(t,n){var i=s.isFunction(t)?t:function(e){return e.get(t)};return s[e](this.models,i,n)}});var x=e.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},_=/^(\S+)\s*(.*)$/,C=["model","collection","el","id","attributes","className","tagName","events"];s.extend(x.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=s.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(s.isFunction(n)||(n=this[e[t]]),n){var i=t.match(_),r=i[1],o=i[2];n=s.bind(n,this),r+=".delegateEvents"+this.cid,""===o?this.$el.on(r,n):this.$el.on(r,o,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=s.extend({},s.result(this,"options"),e)),s.extend(this,s.pick(e,C)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var t=s.extend({},s.result(this,"attributes"));this.id&&(t.id=s.result(this,"id")),this.className&&(t["class"]=s.result(this,"className"));var n=e.$("<"+s.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}}),e.sync=function(t,n,i){var r=k[t];s.defaults(i||(i={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:r,dataType:"json"};if(i.url||(o.url=s.result(n,"url")||N()),null!=i.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(i.attrs||n.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),i.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){o.type="POST",i.emulateJSON&&(o.data._method=r);var a=i.beforeSend;i.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",r),a?a.apply(this,arguments):void 0}}"GET"===o.type||i.emulateJSON||(o.processData=!1),"PATCH"!==o.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=i.xhr=e.ajax(s.extend(o,i));return n.trigger("request",n,l,i),l};var k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var S=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},E=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,H=/\*\w+/g,M=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(S.prototype,l,{initialize:function(){},route:function(t,n,i){s.isRegExp(t)||(t=this._routeToRegExp(t)),s.isFunction(n)&&(i=n,n=""),i||(i=this[n]);var r=this;return e.history.route(t,function(o){var a=r._extractParameters(t,o);i&&i.apply(r,a),r.trigger.apply(r,["route:"+n].concat(a)),r.trigger("route",n,a),e.history.trigger("route",r,n,a)}),this},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var e,t=s.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(M,"\\$&").replace(E,"(?:$1)?").replace(T,function(e,t){return t?e:"([^/]+)"}).replace(H,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return s.map(n,function(e){return e?decodeURIComponent(e):null})}});var R=e.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},A=/^[#\/]|\s+$/g,P=/^\/+|\/+$/g,I=/msie [\w.]+/,O=/\/$/;R.started=!1,s.extend(R.prototype,l,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(O,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(A,"")},start:function(t){if(R.started)throw new Error("Backbone.history has already been started");R.started=!0,this.options=s.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),i=document.documentMode,r=I.exec(navigator.userAgent.toLowerCase())&&(!i||7>=i);this.root=("/"+this.root+"/").replace(P,"/"),r&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var o=this.location,a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&a&&o.hash&&(this.fragment=this.getHash().replace(A,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),R.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0});return n},navigate:function(e,t){if(!R.started)return!1;if(t&&t!==!0||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),e.history=new R;var D=function(e,t){var n,i=this;n=e&&s.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},s.extend(n,i,t);var r=function(){this.constructor=n};return r.prototype=i.prototype,n.prototype=new r,e&&s.extend(n.prototype,e),n.__super__=i.prototype,n};f.extend=m.extend=S.extend=x.extend=R.extend=D;var N=function(){throw new Error('A "url" property or function must be specified')},j=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}}}.call(this),define("backbone",["lodash","jquery"],function(e){return function(){var t;return t||e.Backbone}}(this)),Backbone.ChildViewContainer=function(e,t){var n=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(n.prototype,{add:function(e,t){var n=e.cid;this._views[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),t&&(this._indexByCustom[t]=n),this._updateLength()},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var n=e.cid;e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){return e===n?(delete this._indexByCustom[t],!0):void 0},this),delete this._views[n],this._updateLength()},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,n){t.each(this._views,function(i){t.isFunction(i[e])&&i[e].apply(i,n||[])})},_updateLength:function(){this.length=t.size(this._views)}});var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return t.each(i,function(e){n.prototype[e]=function(){var n=t.values(this._views),i=[n].concat(t.toArray(arguments));return t[e].apply(t,i)}}),n}(Backbone,_),Backbone.Wreqr=function(e,t,n){var i={};return i.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var i=null;t.isObject(e)&&!t.isFunction(e)&&(i=e.context,e=e.callback),this.setHandler(n,e,i)},this)},setHandler:function(e,t,n){var i={callback:t,context:n};this._wreqrHandlers[e]=i,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(!t)throw Error("Handler not found for '"+e+"'");return function(){var e=Array.prototype.slice.apply(arguments);return t.callback.apply(t.context,e)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,n),i.CommandStorage=function(){var t=function(e){this.options=e,this._commands={},n.isFunction(this.initialize)&&this.initialize(e)};return n.extend(t.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),t}(),i.Commands=function(e){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var n=Array.prototype.slice.call(arguments);e.Handlers.prototype.constructor.apply(this,n)},execute:function(e,t){e=arguments[0],t=Array.prototype.slice.call(arguments,1),this.hasHandler(e)?this.getHandler(e).apply(this,t):this.storage.addCommand(e,t)},_executeCommands:function(e,t,i){var r=this.storage.getCommands(e);n.each(r.instances,function(e){t.apply(i,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var t,i=e.storageType||this.storageType;t=n.isFunction(i)?new i:i,this.storage=t}})}(i),i.RequestResponse=function(e){return e.Handlers.extend({request:function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);return this.getHandler(e).apply(this,t)}})}(i),i.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,n),i}(Backbone,Backbone.Marionette,_);var Marionette=function(e,t,n){function i(e){return a.call(e)}function r(e,t){var n=Error(e);throw n.name=t||"Error",n}var o={};t.Marionette=o,o.$=t.$;var a=Array.prototype.slice;return o.extend=t.Model.extend,o.getOption=function(e,t){if(e&&t){var n;return n=e.options&&t in e.options&&void 0!==e.options[t]?e.options[t]:e[t]}},o.triggerMethod=function(){function e(e,t,n){return n.toUpperCase()}var t=/(^|:)(\w)/gi,i=function(i){var r="on"+i.replace(t,e),o=this[r];return this.trigger.apply(this,arguments),n.isFunction(o)?o.apply(this,n.tail(arguments)):void 0};return i}(),o.MonitorDOMRefresh=function(){function e(e){e._isShown=!0,i(e)}function t(e){e._isRendered=!0,i(e)}function i(e){e._isShown&&e._isRendered&&n.isFunction(e.triggerMethod)&&e.triggerMethod("dom:refresh")}return function(n){n.listenTo(n,"show",function(){e(n)}),n.listenTo(n,"render",function(){t(n)})}}(),function(e){function t(e,t,i,o){var a=o.split(/\s+/);n.each(a,function(n){var o=e[n];o||r("Method '"+n+"' was configured as an event handler, but does not exist."),e.listenTo(t,i,o,e)})}function i(e,t,n,i){e.listenTo(t,n,i,e)}function o(e,t,i,r){var o=r.split(/\s+/);n.each(o,function(n){var r=e[n];e.stopListening(t,i,r,e)})}function a(e,t,n,i){e.stopListening(t,n,i,e)}function s(e,t,i,r,o){t&&i&&(n.isFunction(i)&&(i=i.call(e)),n.each(i,function(i,a){n.isFunction(i)?r(e,t,a,i):o(e,t,a,i)}))}e.bindEntityEvents=function(e,n,r){s(e,n,r,i,t)},e.unbindEntityEvents=function(e,t,n){s(e,t,n,a,o)}}(o),o.Callbacks=function(){this._deferred=o.$.Deferred(),this._callbacks=[]},n.extend(o.Callbacks.prototype,{add:function(e,t){this._callbacks.push({cb:e,ctx:t}),this._deferred.done(function(n,i){t&&(n=t),e.call(n,i)})},run:function(e,t){this._deferred.resolve(t,e)},reset:function(){var e=this._callbacks;this._deferred=o.$.Deferred(),this._callbacks=[],n.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),o.Controller=function(e){this.triggerMethod=o.triggerMethod,this.options=e||{},n.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,n.extend(o.Controller.prototype,t.Events,{close:function(){this.stopListening(),this.triggerMethod("close"),this.unbind()}}),o.Region=function(e){if(this.options=e||{},this.el=o.getOption(this,"el"),!this.el){var t=Error("An 'el' must be specified for a region.");throw t.name="NoElError",t}if(this.initialize){var n=Array.prototype.slice.apply(arguments);this.initialize.apply(this,n)}},n.extend(o.Region,{buildRegion:function(e,t){var i="string"==typeof e,r="string"==typeof e.selector,o=void 0===e.regionType,a="function"==typeof e;if(!a&&!i&&!r)throw Error("Region must be specified as a Region type, a selector string or an object with selector property");var s,l;i&&(s=e),e.selector&&(s=e.selector),a&&(l=e),!a&&o&&(l=t),e.regionType&&(l=e.regionType);var c=new l({el:s});return e.parentEl&&(c.getEl=function(t){var i=e.parentEl;return n.isFunction(i)&&(i=i()),i.find(t)}),c}}),n.extend(o.Region.prototype,t.Events,{show:function(e){this.ensureEl();var t=e.isClosed||n.isUndefined(e.$el),i=e!==this.currentView;i&&this.close(),e.render(),(i||t)&&this.open(e),this.currentView=e,o.triggerMethod.call(this,"show",e),o.triggerMethod.call(e,"show")},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(e){return o.$(e)},open:function(e){this.$el.empty().append(e.el)},close:function(){var e=this.currentView;e&&!e.isClosed&&(e.close?e.close():e.remove&&e.remove(),o.triggerMethod.call(this,"close"),delete this.currentView)},attachView:function(e){this.currentView=e},reset:function(){this.close(),delete this.$el}}),o.Region.extend=o.extend,o.RegionManager=function(e){var t=e.Controller.extend({constructor:function(t){this._regions={},e.Controller.prototype.constructor.call(this,t)},addRegions:function(e,t){var i={};return n.each(e,function(e,r){"string"==typeof e&&(e={selector:e}),e.selector&&(e=n.defaults({},e,t));var o=this.addRegion(r,e);i[r]=o},this),i},addRegion:function(t,i){var r,o=n.isObject(i),a=n.isString(i),s=!!i.selector;return r=a||o&&s?e.Region.buildRegion(i,e.Region):n.isFunction(i)?e.Region.buildRegion(i,e.Region):i,this._store(t,r),this.triggerMethod("region:add",t,r),r},get:function(e){return this._regions[e]},removeRegion:function(e){var t=this._regions[e];this._remove(e,t)},removeRegions:function(){n.each(this._regions,function(e,t){this._remove(t,e)},this)},closeRegions:function(){n.each(this._regions,function(e){e.close()},this)},close:function(){this.removeRegions();var t=Array.prototype.slice.call(arguments);e.Controller.prototype.close.apply(this,t)},_store:function(e,t){this._regions[e]=t,this._setLength()},_remove:function(e,t){t.close(),delete this._regions[e],this._setLength(),this.triggerMethod("region:remove",e,t)},_setLength:function(){this.length=n.size(this._regions)}}),i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return n.each(i,function(e){t.prototype[e]=function(){var t=n.values(this._regions),i=[t].concat(n.toArray(arguments));return n[e].apply(n,i)}}),t}(o),o.TemplateCache=function(e){this.templateId=e},n.extend(o.TemplateCache,{templateCaches:{},get:function(e){var t=this.templateCaches[e];return t||(t=new o.TemplateCache(e),this.templateCaches[e]=t),t.load()},clear:function(){var e,t=i(arguments),n=t.length;if(n>0)for(e=0;n>e;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),n.extend(o.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var e=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(e),this.compiledTemplate},loadTemplate:function(e){var t=o.$(e).html();return t&&0!==t.length||r("Could not find template: '"+e+"'","NoTemplateError"),t},compileTemplate:function(e){return n.template(e)}}),o.Renderer={render:function(e,t){if(!e){var n=Error("Cannot render the template since it's false, null or undefined.");throw n.name="TemplateNotFoundError",n}var i;return i="function"==typeof e?e:o.TemplateCache.get(e),i(t)}},o.View=t.View.extend({constructor:function(){n.bindAll(this,"render");var e=Array.prototype.slice.apply(arguments);t.View.prototype.constructor.apply(this,e),o.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:o.triggerMethod,getTemplate:function(){return o.getOption(this,"template")},mixinTemplateHelpers:function(e){e=e||{};var t=this.templateHelpers;return n.isFunction(t)&&(t=t.call(this)),n.extend(e,t)},configureTriggers:function(){if(this.triggers){var e={},t=n.result(this,"triggers");return n.each(t,function(t,n){e[n]=function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation();var n={view:this,model:this.model,collection:this.collection};this.triggerMethod(t,n)}},this),e}},delegateEvents:function(e){this._delegateDOMEvents(e),o.bindEntityEvents(this,this.model,o.getOption(this,"modelEvents")),o.bindEntityEvents(this,this.collection,o.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(e){e=e||this.events,n.isFunction(e)&&(e=e.call(this));var i={},r=this.configureTriggers();n.extend(i,e,r),t.View.prototype.delegateEvents.call(this,i)},undelegateEvents:function(){var e=Array.prototype.slice.call(arguments);t.View.prototype.undelegateEvents.apply(this,e),o.unbindEntityEvents(this,this.model,o.getOption(this,"modelEvents")),o.unbindEntityEvents(this,this.collection,o.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(!this.isClosed){var e=this.triggerMethod("before:close");e!==!1&&(this.isClosed=!0,this.triggerMethod("close"),this.unbindUIElements(),this.remove())}},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var e=n.result(this,"_uiBindings");this.ui={},n.each(n.keys(e),function(t){var n=e[t];this.ui[t]=this.$(n)},this)}},unbindUIElements:function(){this.ui&&(n.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings)}}),o.ItemView=o.View.extend({constructor:function(){o.View.prototype.constructor.apply(this,i(arguments))},serializeData:function(){var e={};return this.model?e=this.model.toJSON():this.collection&&(e={items:this.collection.toJSON()}),e},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var e=this.serializeData();e=this.mixinTemplateHelpers(e);var t=this.getTemplate(),n=o.Renderer.render(t,e);return this.$el.html(n),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){this.isClosed||(this.triggerMethod("item:before:close"),o.View.prototype.close.apply(this,i(arguments)),this.triggerMethod("item:closed"))}}),o.CollectionView=o.View.extend({itemViewEventPrefix:"itemview",constructor:function(){this._initChildViewStorage(),o.View.prototype.constructor.apply(this,i(arguments)),this._initialEvents()},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.render,this))},addChildView:function(e){this.closeEmptyView();var t=this.getItemView(e),n=this.collection.indexOf(e);this.addItemView(e,t,n)},onShowCalled:function(){this.children.each(function(e){o.triggerMethod.call(e,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},_renderChildren:function(){this.closeEmptyView(),this.closeChildren(),this.collection&&this.collection.length>0?this.showCollection():this.showEmptyView()},showCollection:function(){var e;this.collection.each(function(t,n){e=this.getItemView(t),this.addItemView(t,e,n)},this)},showEmptyView:function(){var e=o.getOption(this,"emptyView");if(e&&!this._showingEmptyView){this._showingEmptyView=!0;var n=new t.Model;this.addItemView(n,e,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getItemView:function(){var e=o.getOption(this,"itemView");return e||r("An `itemView` must be specified","NoItemViewError"),e},addItemView:function(e,t,i){var r=o.getOption(this,"itemViewOptions");n.isFunction(r)&&(r=r.call(this,e,i));var a=this.buildItemView(e,t,r);this.addChildViewEventForwarding(a),this.triggerMethod("before:item:added",a),this.children.add(a),this.renderItemView(a,i),this._isShown&&o.triggerMethod.call(a,"show"),this.triggerMethod("after:item:added",a)},addChildViewEventForwarding:function(e){var t=o.getOption(this,"itemViewEventPrefix");this.listenTo(e,"all",function(){var n=i(arguments);n[0]=t+":"+n[0],n.splice(1,0,e),o.triggerMethod.apply(this,n)},this)},renderItemView:function(e,t){e.render(),this.appendHtml(this,e,t)},buildItemView:function(e,t,i){var r=n.extend({model:e},i);return new t(r)},removeItemView:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},removeChildView:function(e){e&&(this.stopListening(e),e.close?e.close():e.remove&&e.remove(),this.children.remove(e)),this.triggerMethod("item:removed",e)},checkEmpty:function(){this.collection&&0!==this.collection.length||this.showEmptyView()},appendHtml:function(e,t){e.$el.append(t.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},close:function(){this.isClosed||(this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),o.View.prototype.close.apply(this,i(arguments)))},closeChildren:function(){this.children.each(function(e){this.removeChildView(e)},this),this.checkEmpty()}}),o.CompositeView=o.CollectionView.extend({constructor:function(){o.CollectionView.prototype.constructor.apply(this,i(arguments))},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this._renderChildren,this))},getItemView:function(){var e=o.getOption(this,"itemView")||this.constructor;return e||r("An `itemView` must be specified","NoItemViewError"),e},serializeData:function(){var e={};return this.model&&(e=this.model.toJSON()),e},render:function(){this.isRendered=!0,this.isClosed=!1,this.resetItemViewContainer(),this.triggerBeforeRender();var e=this.renderModel();return this.$el.html(e),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this._renderChildren(),this.triggerMethod("composite:rendered"),this.triggerRendered(),this},_renderChildren:function(){this.isRendered&&(o.CollectionView.prototype._renderChildren.call(this),this.triggerMethod("composite:collection:rendered"))},renderModel:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e);var t=this.getTemplate();return o.Renderer.render(t,e)},appendHtml:function(e,t){var n=this.getItemViewContainer(e);n.append(t.el)},getItemViewContainer:function(e){if("$itemViewContainer"in e)return e.$itemViewContainer;var t;if(e.itemViewContainer){var i=n.result(e,"itemViewContainer");t=e.$(i),0>=t.length&&r("The specified `itemViewContainer` was not found: "+e.itemViewContainer,"ItemViewContainerMissingError")}else t=e.$el;return e.$itemViewContainer=t,t},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),o.Layout=o.ItemView.extend({regionType:o.Region,constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),o.ItemView.prototype.constructor.call(this,e)},render:function(){this._firstRender?this._firstRender=!1:this.isClosed?this._initializeRegions():this._reInitializeRegions();var e=Array.prototype.slice.apply(arguments),t=o.ItemView.prototype.render.apply(this,e);return t},close:function(){if(!this.isClosed){this.regionManager.close();var e=Array.prototype.slice.apply(arguments);o.ItemView.prototype.close.apply(this,e)}},addRegion:function(e,t){var n={};return n[e]=t,this.addRegions(n)[e]},addRegions:function(e){return this.regions=n.extend(this.regions||{},e),this._buildRegions(e)},removeRegion:function(e){return this.regionManager.removeRegion(e)},_buildRegions:function(e){var t=this,n={parentEl:function(){return t.$el}};return this.regionManager.addRegions(e,n)},_initializeRegions:function(e){var t;this._initRegionManager(),t=n.isFunction(this.regions)?this.regions(e):this.regions||{},this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.closeRegions(),this.regionManager.each(function(e){e.reset()})},_initRegionManager:function(){this.regionManager=new o.RegionManager,this.listenTo(this.regionManager,"region:add",function(e,t){this[e]=t,this.trigger("region:add",e,t)}),this.listenTo(this.regionManager,"region:remove",function(e,t){delete this[e],this.trigger("region:remove",e,t)})}}),o.AppRouter=t.Router.extend({constructor:function(e){if(t.Router.prototype.constructor.apply(this,i(arguments)),this.options=e,this.appRoutes){var n=o.getOption(this,"controller");
this.processAppRoutes(n,this.appRoutes)}},processAppRoutes:function(e,t){var i=n.keys(t).reverse();n.each(i,function(i){var r=t[i],o=e[r];if(!o)throw Error("Method '"+r+"' was not found on the controller");this.route(i,r,n.bind(o,e))},this)}}),o.Application=function(e){this._initRegionManager(),this._initCallbacks=new o.Callbacks,this.vent=new t.Wreqr.EventAggregator,this.commands=new t.Wreqr.Commands,this.reqres=new t.Wreqr.RequestResponse,this.submodules={},n.extend(this,e),this.triggerMethod=o.triggerMethod},n.extend(o.Application.prototype,t.Events,{execute:function(){var e=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,e)},request:function(){var e=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,e)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("initialize:before",e),this._initCallbacks.run(e,this),this.triggerMethod("initialize:after",e),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},removeRegion:function(e){this._regionManager.removeRegion(e)},module:function(){var e=i(arguments);return e.unshift(this),o.Module.create.apply(o.Module,e)},_initRegionManager:function(){this._regionManager=new o.RegionManager,this.listenTo(this._regionManager,"region:add",function(e,t){this[e]=t}),this.listenTo(this._regionManager,"region:remove",function(e){delete this[e]})}}),o.Application.extend=o.extend,o.Module=function(e,t){this.moduleName=e,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,this.startWithParent=!0,this.triggerMethod=o.triggerMethod},n.extend(o.Module.prototype,t.Events,{addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){this._isInitialized||(n.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,o.triggerMethod.call(this,"before:stop"),n.each(this.submodules,function(e){e.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),o.triggerMethod.call(this,"stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,i){if(e){var r=n.flatten([this,this.app,t,o,o.$,n,i]);e.apply(this,r)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks}}),n.extend(o.Module,{create:function(e,t,r){var o=e,a=i(arguments);a.splice(0,3),t=t.split(".");var s=t.length,l=[];return l[s-1]=r,n.each(t,function(t,n){var i=o;o=this._getModule(i,t,e),this._addModuleDefinition(i,o,l[n],a)},this),o},_getModule:function(e,t,n){var i=e[t];return i||(i=new o.Module(t,n),e[t]=i,e.submodules[t]=i),i},_addModuleDefinition:function(e,t,i,r){var o,a;n.isFunction(i)?(o=i,a=!0):n.isObject(i)?(o=i.define,a=i.startWithParent):a=!0,o&&t.addDefinition(o,r),t.startWithParent=t.startWithParent&&a,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}}),o}(this,Backbone,_);define("marionette",["backbone"],function(e){return function(){var t;return t||e.Marionette}}(this)),define("app/router",["app/core","app/core"],function(){return Backbone.Router.extend({routes:{"":"index",":room":"room"},index:function(){var e=require("app/core");e.Connection.stop(),e.Halloween.stop(),e.Navigation.start(),e.Gatekeeper.start()},room:function(){var e=require("app/core");e.Gatekeeper.stop(),e.Connection.start(),e.Halloween.start(),e.Navigation.start()}})}),define("app/core",["app/router"],function(e){var t=new Marionette.Application;return t.addInitializer(function(){t.router=new e}),t.addRegions({body:"#region--body",modal:"#region--modal",navigation:"#region--navigation"}),t.on("start",function(){Backbone.history.start({hashChange:!1,pushState:!0})}),t}),define("app/connection/core",["app/core",window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.RTCPeerConnection?"app/connection/controllers/webrtc":"app/connection/controllers/fallback"],function(e,t){!!window.webkitRTCPeerConnection||!!window.mozRTCPeerConnection||!!window.RTCPeerConnection;var n=e.module("Connection",function(){this.startWithParent=!1,this.controller=new t}),i=n.controller;return n.on("start",function(){i.connect()}),n.on("stop",function(){_.result(i,"disconnect")}),e.reqres.setHandler("connection:supported",function(){return!!window.webkitRTCPeerConnection||!!window.mozRTCPeerConnection||!!window.RTCPeerConnection}),e.reqres.setHandler("connection:streams",function(){return i.collection}),e.commands.setHandler("connection:mute",function(){i.mute()}),e.commands.setHandler("connection:unmute",function(){i.unmute()}),e.commands.setHandler("connection:pause",function(){i.pause()}),e.commands.setHandler("connection:resume",function(){i.resume()}),n}),define("text",{});var Handlebars={};!function(e,t){e.VERSION="1.0.0",e.COMPILER_REVISION=4,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},e.helpers={},e.partials={};var n=Object.prototype.toString,i="[object Function]",r="[object Object]";e.registerHelper=function(t,i,o){if(n.call(t)===r){if(o||i)throw new e.Exception("Arg not supported with multiple helpers");e.Utils.extend(this.helpers,t)}else o&&(i.not=o),this.helpers[t]=i},e.registerPartial=function(t,i){n.call(t)===r?e.Utils.extend(this.partials,t):this.partials[t]=i},e.registerHelper("helperMissing",function(e){if(2===arguments.length)return t;throw new Error("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,r){var o=r.inverse||function(){},a=r.fn,s=n.call(t);return s===i&&(t=t.call(this)),t===!0?a(this):t===!1||null==t?o(this):"[object Array]"===s?t.length>0?e.helpers.each(t,r):o(this):a(t)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var n=new e.K;return e.K.prototype=null,n},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(t,n){if(e.logger.level<=t){var i=e.logger.methodMap[t];"undefined"!=typeof console&&console[i]&&console[i].call(console,n)}}},e.log=function(t,n){e.logger.log(t,n)},e.registerHelper("each",function(t,r){var o,a=r.fn,s=r.inverse,l=0,c="",u=n.call(t);if(u===i&&(t=t.call(this)),r.data&&(o=e.createFrame(r.data)),t&&"object"==typeof t)if(t instanceof Array)for(var h=t.length;h>l;l++)o&&(o.index=l),c+=a(t[l],{data:o});else for(var p in t)t.hasOwnProperty(p)&&(o&&(o.key=p),c+=a(t[p],{data:o}),l++);return 0===l&&(c=s(this)),c}),e.registerHelper("if",function(t,r){var o=n.call(t);return o===i&&(t=t.call(this)),!t||e.Utils.isEmpty(t)?r.inverse(this):r.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn})}),e.registerHelper("with",function(t,r){var o=n.call(t);return o===i&&(t=t.call(this)),e.Utils.isEmpty(t)?void 0:r.fn(t)}),e.registerHelper("log",function(t,n){var i=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;e.log(i,t)});var o=["description","fileName","lineNumber","message","name","number","stack"];e.Exception=function(){for(var e=Error.prototype.constructor.apply(this,arguments),t=0;t<o.length;t++)this[o[t]]=e[o[t]]},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()};var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},s=/[&<>"'`]/g,l=/[&<>"'`]/,c=function(e){return a[e]||"&amp;"};e.Utils={extend:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},escapeExpression:function(t){return t instanceof e.SafeString?t.toString():null==t||t===!1?"":(t=t.toString(),l.test(t)?t.replace(s,c):t)},isEmpty:function(e){return e||0===e?"[object Array]"===n.call(e)&&0===e.length?!0:!1:!0}},e.VM={template:function(t){var n={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,n,i){var r=this.programs[t];return i?r=e.VM.program(t,n,i):r||(r=this.programs[t]=e.VM.program(t,n)),r},merge:function(t,n){var i=t||n;return t&&n&&(i={},e.Utils.extend(i,n),e.Utils.extend(i,t)),i},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(i,r){r=r||{};var o=t.call(n,e,i,r.helpers,r.partials,r.data),a=n.compilerInfo||[],s=a[0]||1,l=e.COMPILER_REVISION;if(s!==l){if(l>s){var c=e.REVISION_CHANGES[l],u=e.REVISION_CHANGES[s];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+c+") or downgrade your runtime to an older version ("+u+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+")."}return o}},programWithDepth:function(e,t,n){var i=Array.prototype.slice.call(arguments,3),r=function(e,r){return r=r||{},t.apply(this,[e,r.data||n].concat(i))};return r.program=e,r.depth=i.length,r},program:function(e,t,n){var i=function(e,i){return i=i||{},t(e,i.data||n)};return i.program=e,i.depth=0,i},noop:function(){return""},invokePartial:function(n,i,r,o,a,s){var l={helpers:o,partials:a,data:s};if(n===t)throw new e.Exception("The partial "+i+" could not be found");if(n instanceof Function)return n(r,l);if(e.compile)return a[i]=e.compile(n,{data:s!==t}),a[i](r,l);throw new e.Exception("The partial "+i+" could not be compiled when running in runtime-only mode")}},e.template=e.VM.template}(Handlebars),define("Handlebars",function(e){return function(){var t;return t||e.Handlebars}}(this)),define("hbars",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("hbars!app/navigation/templates/visitor",["Handlebars"],function(e){return e.template(function(e,t,n,i,r){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{},'<menu class="menu halloween__menu--info">\n\n	<span class="menu__close">&times;</span>\n\n	<header class="menu__header">\n		<a class="halloween__menu__pointless" href="http://pointlesscorp.com">Pointless Corp</a>\n	</header>\n\n	<p>\n		Haunted Hills gets its sweet moves from <a\n		href="http://wagerfield.github.io/parallax/"\n		target="_blank">Parallax.JS</a> and is powered by\n		<a href="https://github.com/vigetlabs/doppelganger"\n		target="_blank">Doppelganger</a>, a simple <a\n		href="http://www.webrtc.org/" target="_blank">WebRTC</a> video\n		platform made by a few <a href="https://viget.com"\n		target="_blank">Viget</a> zombies at <a\n		href="https://pointlesscorp.com" target="_blank">Pointless\n		Corp</a>. While it’s fun to look at on almost any device\n		(especially phones and tablets) — use the latest versions of\n		<a href="https://www.google.com/intl/en/chrome/browser/" target="_blank">Chrome</a>\n		or\n		<a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a>\n		to get the full experience.\n	</p>\n\n	<br/>\n\n	<div class="field--horizontal">\n		<button class="btn" type="submit">Visit Haunted Hills</button>\n	</div>\n\n</menu>'})}),define("app/navigation/views/visitor",["hbars!../templates/visitor"],function(e){return Marionette.ItemView.extend({className:"modal",template:e,events:{click:"handleModalClick","click .menu__close":"remove","click .btn":"remove"},ui:{menu:".menu"},remove:function(){this.ui.menu.addClass("effect__fade-away"),setTimeout(Marionette.ItemView.prototype.remove.bind(this),700)},handleModalClick:function(e){e.target==this.el&&this.remove()}})}),define("hbars!app/navigation/templates/information",["Handlebars"],function(e){return e.template(function(e,t,n,i,r){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{},'<menu class="menu halloween__menu--info">\n\n	<span class="menu__close">&times;</span>\n\n	<header class="menu__header">\n		<a class="halloween__menu__pointless" href="http://pointlesscorp.com">\n			Pointless Corp\n		</a>\n	</header>\n\n	<p>\n		Haunted Hills gets its sweet moves from <a\n		href="http://wagerfield.github.io/parallax/"\n		target="_blank">Parallax.JS</a> and is powered by\n		<a href="https://github.com/vigetlabs/doppelganger"\n		target="_blank">Doppelganger</a>, a simple <a\n		href="http://www.webrtc.org/" target="_blank">WebRTC</a> video\n		platform made by a few <a href="https://viget.com"\n		target="_blank">Viget</a> zombies at <a\n		href="https://pointlesscorp.com" target="_blank">Pointless\n		Corp</a>. While it’s fun to look at on almost any device\n		(especially phones and tablets) — use the latest versions of\n		<a href="https://www.google.com/intl/en/chrome/browser/" target="_blank">Chrome</a>\n		or\n		<a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a>\n		to get the full experience.\n	</p>\n\n	<ul class="halloween__menu__credit-list">\n		<li>\n			<a href="https://github.com/vigetlabs/doppelganger" target="_blank"><img src="/images/halloween/logos/doppelganger.jpg"></a>\n		</li>\n		<li>\n			<a href="http://www.webrtc.org/" target="_blank"><img src="/images/halloween/logos/webrtc.jpg"></a>\n 		</li>\n		<li>\n			<a href="http://wagerfield.github.io/parallax/" target="_blank"><img src="/images/halloween/logos/parallaxjs.jpg"></a>\n		</li>\n	</ul>\n</menu>'})}),define("app/navigation/views/information",["hbars!../templates/information"],function(e){return Marionette.ItemView.extend({className:"modal",template:e,events:{click:"handleModalClick","click .menu__close":"remove"},ui:{menu:".menu"},remove:function(){this.ui.menu.addClass("effect__fade-away"),setTimeout(Marionette.ItemView.prototype.remove.bind(this),700)},handleModalClick:function(e){e.target==this.el&&this.remove()}})}),define("hbars!app/navigation/templates/utility",["Handlebars"],function(e){return e.template(function(e,t,n,i,r){function o(){return'\n		<li>\n			<a href="#" class="actionbar__nav__control actionbar__nav__control--mute">\n				<i class="icon">&#xe602;</i>\n				<i class="visually-hidden">Mute Microphone</i>\n			</a>\n		</li>\n		<li>\n			<a href="#" class="actionbar__nav__control actionbar__nav__control--pause">\n				<i class="icon">&#xe603;</i>\n				<i class="visually-hidden">Pause Video</i>\n			</a>\n		</li>\n		'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var a,s="",l=this,c="function",u=this.escapeExpression;return s+='<nav class="actionbar">\n	<a href="/" class="actionbar__logo">Doppelganger</a>\n	<ul class="actionbar__nav">\n		',a=n["if"].call(t,t.hasWebRTC,{hash:{},inverse:l.noop,fn:l.program(1,o,r),data:r}),(a||0===a)&&(s+=a),s+='\n		<li>\n			<a href="#" class="actionbar__nav__control actionbar__nav__control--info actionbar__nav__control--social">\n				<i class="icon">&#xe606;</i>\n				<i class="visually-hidden">Info</i>\n			</a>\n		</li>\n		<li>\n			<a href="http://twitter.com/home?status=',(a=n.tweet)?a=a.call(t,{hash:{},data:r}):(a=t.tweet,a=typeof a===c?a.apply(t):a),s+=u(a)+"+",(a=n.url)?a=a.call(t,{hash:{},data:r}):(a=t.url,a=typeof a===c?a.apply(t):a),s+=u(a)+'" target="_blank" class="actionbar__nav__control actionbar__nav__control--social" data-title="Twitter">\n				<i class="icon">&#xe604;</i>\n				<i class="visually-hidden">Share on Twitter</i>\n			</a>\n		</li>\n		<li>\n			<a href="http://www.facebook.com/sharer/sharer.php?s=100&p[url]=',(a=n.url)?a=a.call(t,{hash:{},data:r}):(a=t.url,a=typeof a===c?a.apply(t):a),s+=u(a)+"&p[title]=",(a=n.title)?a=a.call(t,{hash:{},data:r}):(a=t.title,a=typeof a===c?a.apply(t):a),s+=u(a)+"&p[summary]=",(a=n.summary)?a=a.call(t,{hash:{},data:r}):(a=t.summary,a=typeof a===c?a.apply(t):a),s+=u(a)+"&p[images][0]=",(a=n.image)?a=a.call(t,{hash:{},data:r}):(a=t.image,a=typeof a===c?a.apply(t):a),s+=u(a)+'" target="_blank" class="actionbar__nav__control actionbar__nav__control--social" data-title="Facebook">\n				<i class="icon">&#xe605;</i>\n				<i class="visually-hidden">Share on Facebook</i>\n			</a>\n		</li>\n	</ul>\n</nav>'})}),define("app/navigation/views/utility",["app/core","./information","hbars!../templates/utility"],function(e,t,n){return Marionette.ItemView.extend({template:n,events:{"click .actionbar__nav__control--mute":"toggleMute","click .actionbar__nav__control--pause":"togglePause","click .actionbar__nav__control--info":"showInfo","click .actionbar__logo":"visitLobby"},ui:{mute:".actionbar__nav__control--mute",pause:".actionbar__nav__control--pause"},toggleMute:function(t){var n=this.ui.mute.toggleClass("is-active").hasClass("is-active"),i=n?"mute":"unmute";e.execute("connection:"+i),t.preventDefault()},togglePause:function(t){var n=this.ui.pause.toggleClass("is-active").hasClass("is-active"),i=n?"pause":"resume";e.execute("connection:"+i),t.preventDefault()},serializeData:function(){return{hasWebRTC:e.request("connection:supported"),url:window.location,summary:"I’m waiting for you in Haunted Hills — join me for a scary-good time.",title:"Join me in Haunted Hills",image:window.location+"/images/halloween/fb.jpeg",tweet:"Join me in Haunted Hills — it’s a scary-good time."}},showInfo:function(n){e.modal.show(new t),n.preventDefault()},visitLobby:function(t){e.router.navigate("",{trigger:!0}),t.preventDefault()}})}),define("app/navigation/core",["app/core","./views/visitor","./views/utility"],function(e,t,n){var i=e.module("Navigation",function(){this.startWithParent=!1,e.request("connection:supported")&&window.location.pathname.length>2&&e.modal.show(new t)});return i.on("start",function(){e.navigation.show(new n)}),i.on("stop",function(){e.navigation.reset()}),i}),function(e,t,n,i){function r(t,n){this.element=t,this.$context=e(t).data("api",this),this.$layers=this.$context.find(".layer");var i={calibrateX:this.$context.data("calibrate-x")||null,calibrateY:this.$context.data("calibrate-y")||null,invertX:this.$context.data("invert-x")||null,invertY:this.$context.data("invert-y")||null,limitX:parseFloat(this.$context.data("limit-x"))||null,limitY:parseFloat(this.$context.data("limit-y"))||null,scalarX:parseFloat(this.$context.data("scalar-x"))||null,scalarY:parseFloat(this.$context.data("scalar-y"))||null,frictionX:parseFloat(this.$context.data("friction-x"))||null,frictionY:parseFloat(this.$context.data("friction-y"))||null};for(var r in i)null===i[r]&&delete i[r];e.extend(this,s,n,i),this.calibrationTimer=null,this.calibrationFlag=!0,this.enabled=!1,this.depths=[],this.raf=null,this.ox=0,this.oy=0,this.ow=0,this.oh=0,this.cx=0,this.cy=0,this.ix=0,this.iy=0,this.mx=0,this.my=0,this.vx=0,this.vy=0,this.onMouseMove=this.onMouseMove.bind(this),this.onDeviceOrientation=this.onDeviceOrientation.bind(this),this.onOrientationTimer=this.onOrientationTimer.bind(this),this.onCalibrationTimer=this.onCalibrationTimer.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onWindowResize=this.onWindowResize.bind(this),this.initialise()}var o="parallax",a=30,s={calibrationThreshold:100,calibrationDelay:500,supportDelay:500,calibrateX:!1,calibrateY:!0,invertX:!0,invertY:!0,limitX:!1,limitY:!1,scalarX:10,scalarY:10,frictionX:.1,frictionY:.1};r.prototype.transformSupport=function(e){for(var r=n.createElement("div"),o=!1,a=null,s=!1,l=null,c=null,u=0,h=this.vendors.length;h>u;u++)if(null!==this.vendors[u]?(l=this.vendors[u][0]+"transform",c=this.vendors[u][1]+"Transform"):(l="transform",c="transform"),r.style[c]!==i){o=!0;break}switch(e){case"2D":s=o;break;case"3D":o&&(n.body.appendChild(r),r.style[c]="translate3d(1px,1px,1px)",a=t.getComputedStyle(r).getPropertyValue(l),s=a!==i&&a.length>0&&"none"!==a,n.body.removeChild(r))}return s},r.prototype.ww=null,r.prototype.wh=null,r.prototype.hw=null,r.prototype.hh=null,r.prototype.portrait=null,r.prototype.desktop=!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|BB10|mobi|tablet|opera mini|nexus 7)/i),r.prototype.vendors=[null,["-webkit-","webkit"],["-moz-","Moz"],["-o-","O"],["-ms-","ms"]],r.prototype.motionSupport=!!t.DeviceMotionEvent,r.prototype.orientationSupport=!!t.DeviceOrientationEvent,r.prototype.orientationStatus=0,r.prototype.transform2DSupport=r.prototype.transformSupport("2D"),r.prototype.transform3DSupport=r.prototype.transformSupport("3D"),r.prototype.initialise=function(){"static"===this.$context.css("position")&&this.$context.css({position:"relative"}),this.$layers.css({position:"absolute",display:"block",height:"100%",width:"100%",left:0,top:0}),this.$layers.first().css({position:"relative"}),this.$layers.each(e.proxy(function(t,n){this.depths.push(e(n).data("depth")||0)},this)),this.accelerate(this.$context),this.accelerate(this.$layers),this.updateDimensions(),this.enable(),this.queueCalibration(this.calibrationDelay)},r.prototype.updateDimensions=function(){this.ox=this.$context.offset().left,this.oy=this.$context.offset().top,this.ow=this.$context.width(),this.oh=this.$context.height(),this.ww=t.innerWidth,this.wh=t.innerHeight,this.hw=this.ww/2,this.hh=this.wh/2},r.prototype.queueCalibration=function(e){clearTimeout(this.calibrationTimer),this.calibrationTimer=setTimeout(this.onCalibrationTimer,e)},r.prototype.enable=function(){this.enabled||(this.enabled=!0,this.orientationSupport?(this.portrait=null,t.addEventListener("deviceorientation",this.onDeviceOrientation),setTimeout(this.onOrientationTimer,this.supportDelay)):(this.cx=0,this.cy=0,this.portrait=!1,t.addEventListener("mousemove",this.onMouseMove)),t.addEventListener("resize",this.onWindowResize),this.raf=requestAnimationFrame(this.onAnimationFrame))},r.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.orientationSupport?t.removeEventListener("deviceorientation",this.onDeviceOrientation):t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("resize",this.onWindowResize),cancelAnimationFrame(this.raf))},r.prototype.calibrate=function(e,t){this.calibrateX=e===i?this.calibrateX:e,this.calibrateY=t===i?this.calibrateY:t},r.prototype.invert=function(e,t){this.invertX=e===i?this.invertX:e,this.invertY=t===i?this.invertY:t},r.prototype.friction=function(e,t){this.frictionX=e===i?this.frictionX:e,this.frictionY=t===i?this.frictionY:t},r.prototype.scalar=function(e,t){this.scalarX=e===i?this.scalarX:e,this.scalarY=t===i?this.scalarY:t},r.prototype.limit=function(e,t){this.limitX=e===i?this.limitX:e,this.limitY=t===i?this.limitY:t},r.prototype.clamp=function(e,t,n){return e=Math.max(e,t),e=Math.min(e,n)},r.prototype.css=function(t,n,r){for(var o=null,a=0,s=this.vendors.length;s>a;a++)if(o=null!==this.vendors[a]?e.camelCase(this.vendors[a][1]+"-"+n):n,t.style[o]!==i){t.style[o]=r;break}},r.prototype.accelerate=function(e){for(var t=0,n=e.length;n>t;t++){var i=e[t];this.css(i,"transform","translate3d(0,0,0)"),this.css(i,"transform-style","preserve-3d"),this.css(i,"backface-visibility","hidden")}},r.prototype.setPosition=function(e,t,n){t+="%",n+="%",this.transform3DSupport?this.css(e,"transform","translate3d("+t+","+n+",0)"):this.transform2DSupport?this.css(e,"transform","translate("+t+","+n+")"):(e.style.left=t,e.style.top=n)},r.prototype.onOrientationTimer=function(){this.orientationSupport&&0===this.orientationStatus&&(this.disable(),this.orientationSupport=!1,this.enable())},r.prototype.onCalibrationTimer=function(){this.calibrationFlag=!0},r.prototype.onWindowResize=function(){this.updateDimensions()},r.prototype.onAnimationFrame=function(){var e=this.ix-this.cx,t=this.iy-this.cy;(Math.abs(e)>this.calibrationThreshold||Math.abs(t)>this.calibrationThreshold)&&this.queueCalibration(0),this.portrait?(this.mx=(this.calibrateX?t:this.iy)*this.scalarX,this.my=(this.calibrateY?e:this.ix)*this.scalarY):(this.mx=(this.calibrateX?e:this.ix)*this.scalarX,this.my=(this.calibrateY?t:this.iy)*this.scalarY),isNaN(parseFloat(this.limitX))||(this.mx=this.clamp(this.mx,-this.limitX,this.limitX)),isNaN(parseFloat(this.limitY))||(this.my=this.clamp(this.my,-this.limitY,this.limitY)),this.vx+=(this.mx-this.vx)*this.frictionX,this.vy+=(this.my-this.vy)*this.frictionY;for(var n=0,i=this.$layers.length;i>n;n++){var r=this.depths[n],o=this.$layers[n],a=this.vx*r*(this.invertX?-1:1),s=this.vy*r*(this.invertY?-1:1);this.setPosition(o,a,s)}this.raf=requestAnimationFrame(this.onAnimationFrame)},r.prototype.onDeviceOrientation=function(e){if(!this.desktop&&null!==e.beta&&null!==e.gamma){this.orientationStatus=1;var n=(e.beta||0)/a,i=(e.gamma||0)/a,r=t.innerHeight>t.innerWidth;this.portrait!==r&&(this.portrait=r,this.calibrationFlag=!0),this.calibrationFlag&&(this.calibrationFlag=!1,this.cx=n,this.cy=i),this.ix=n,this.iy=i}},r.prototype.onMouseMove=function(e){this.ix=(e.pageX-this.hw)/this.hw,this.iy=(e.pageY-this.hh)/this.hh};var l={enable:r.prototype.enable,disable:r.prototype.disable,calibrate:r.prototype.calibrate,friction:r.prototype.friction,invert:r.prototype.invert,scalar:r.prototype.scalar,limit:r.prototype.limit};e.fn[o]=function(t){var n=arguments;return this.each(function(){var i=e(this),a=i.data(o);a||(a=new r(this,t),i.data(o,a)),l[t]&&a[t].apply(a,Array.prototype.slice.call(n,1))})}}(window.jQuery||window.Zepto,window,document),function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;t.length>n&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=(new Date).getTime(),i=Math.max(0,16-(n-e)),r=window.setTimeout(function(){t(n+i)},i);return e=n+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),define("vendor/jquery.parallax",function(){}),define("app/halloween/views/scene",["vendor/jquery.parallax"],function(){return Marionette.ItemView.extend({className:"scene halloween__scene",tagName:"ul",ui:{layers:".layer",masks:".mask",canvases:"canvas"},initialize:function(){$(window).on("resize.scene",this.resize.bind(this)),this.bindUIElements(),this.resize(),this.$el.parallax()},resize:_.throttle(function(){var e=window.innerHeight-$("#region--footer").height();this.$el.width(window.innerWidth),this.$el.height(e)},100),play:function(){this.videoLoop()},pause:function(){this.cancel()},serializeMask:function(e,t,n,i){var r=e.toJSON(),o=r.videoEl,a=t/o.videoWidth,s=n/o.videoHeight,l=r.scale=Math.max(a,s)*i,c=r.height=o.videoHeight*l,u=r.width=o.videoWidth*l;return r.x=.5*(u-t),r.y=.5*(c-n),r},draw:function(){this.collection.each(function(e,t){var n=this.ui.canvases.get(t),i=this.ui.masks.get(t),r=n.getContext("2d"),o=parseFloat(i.getAttribute("data-zoom"),10),a=this.serializeMask(e,i.width,i.height,o);r.clearRect(0,0,n.width,n.height),r.save(),r.drawImage(a.videoEl,-a.x,-a.y,a.width,a.height),r.fillStyle=i.getAttribute("data-hue"),r.fillRect(0,0,n.width,n.height),r.globalCompositeOperation="destination-in",r.drawImage(i,0,0),r.restore()},this)},cancel:function(){cancelAnimationFrame(this.frame)},videoLoop:function(){this.cancel();var e=Date.now();this.frame=requestAnimationFrame(function t(){var n=Date.now()-e>1e3/30;this.frame=requestAnimationFrame(t.bind(this)),n&&(e=Date.now(),this.draw())}.bind(this))}})}),define("app/halloween/core",["app/core","app/connection/core","./views/scene"],function(e,t,n){var i=e.module("Halloween",function(){this.startWithParent=!1}),r=new n({el:".halloween__scene",collection:e.request("connection:streams")});return i.on("start",function(){r.play()}),i.on("stop",function(){r.pause()}),i}),define("hbars!app/gatekeeper/templates/lobby",["Handlebars"],function(e){return e.template(function(e,t,n,i,r){function o(e,t){var i,r="";return r+='\n		<div class="menu__backface">\n			<div class="halloween__menu__header">\n				<h3>Welcome to Haunted Hills</h3>\n				<p>\n					A fun Halloween experiment using <a\n    					href="http://www.webrtc.org/"\n						target="_blank">WebRTC</a> Video and\n					<a href="http://wagerfield.github.io/parallax/"\n						target="_blank">Parallax.JS</a>.\n					Fire up your webcam, share with your friends, and\n					have a scary-good time.\n				</p>\n			</div>\n\n			<ol class="halloween__menu__instructions">\n				<li>\n					<img src="/images/stare.png" height="107" width="106">\n					<h3>Stare</h3>\n					<p>at your webcam</p>\n				</li>\n				<li>\n					<img src="/images/share.png" height="107" width="106">\n					<h3>Share</h3>\n					<p>with your friends</p>\n				</li>\n				<li>\n					<img src="/images/scare.png" height="107" width="106">\n					<h3>Scare</h3>\n					<p>the snot out of them</p>\n				</li>\n			</ol>\n\n			<form class="form--lobby">\n				<input type="hidden" name="room_name" value="',(i=n.uuid)?i=i.call(e,{hash:{},data:t}):(i=e.uuid,i=typeof i===c?i.apply(e):i),r+=u(i)+'">\n				<div class="field field--horizontal">\n					<label>Session URL:</label>\n					<input disabled type="text" class="input--text" value="',(i=n.location)?i=i.call(e,{hash:{},data:t}):(i=e.location,i=typeof i===c?i.apply(e):i),r+=u(i)+"/",(i=n.uuid)?i=i.call(e,{hash:{},data:t}):(i=e.uuid,i=typeof i===c?i.apply(e):i),r+=u(i)+'">\n					<button class="btn" type="submit">Visit Haunted Hills</button>\n				</div>\n			</form>\n\n			<small class="menu__legal">\n				* We\'ve detected that you are using Chrome, Firefox,\n			or another WebRTC capable browser. Thanks for making the\n			internet a happier place.\n			</small>\n		</div>\n	'}function a(){return'\n    	<div class="menu__backface is-error">\n			<div class="halloween__menu__header">\n				<h2>BOO!*</h2>\n				<p>\n					Your browser isn’t welcome in Haunted\n					Hills. Although it’s still fun to look at — you\n					really should download\n					<a href="https://www.google.com/intl/en/chrome/browser/" target="_blank">Chrome</a>\n					or\n					<a href="http://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox</a>\n					to get the full experience.\n				</p>\n				<br>\n				<button class="btn js--skip">Take me there anyway</button>\n				<small class="halloween__menu__caveat">* disappointed "Boo" not intimidating scary "Boo"</small>\n			</div>\n		</div>\n	'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,l="",c="function",u=this.escapeExpression,h=this;return l+='<menu class="menu">\n\n	<div class="menu__frontface">\n		<img src="/images/postcard.jpg">\n	</div>\n\n	',s=n["if"].call(t,t.hasWebRTC,{hash:{},inverse:h.program(3,a,r),fn:h.program(1,o,r),data:r}),(s||0===s)&&(l+=s),l+="\n	</div>\n</menu>"})}),define("app/gatekeeper/lib/uuid",[],function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");Math.uuid=function(t,n){var i,r=e,o=[];if(n=n||r.length,t)for(i=0;t>i;i++)o[i]=r[0|Math.random()*n];else{var a;for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",i=0;36>i;i++)o[i]||(a=0|16*Math.random(),o[i]=r[19==i?8|3&a:a])}return o.join("")},Math.uuidFast=function(){for(var t,n=e,i=new Array(36),r=0,o=0;36>o;o++)8==o||13==o||18==o||23==o?i[o]="-":14==o?i[o]="4":(2>=r&&(r=0|33554432+16777216*Math.random()),t=15&r,r>>=4,i[o]=n[19==o?8|3&t:t]);return i.join("")},Math.uuidCompact=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=0|16*Math.random(),n="x"==e?t:8|3&t;return n.toString(16)})}}),define("app/gatekeeper/views/Lobby",["app/core","hbars!../templates/lobby","app/gatekeeper/lib/uuid"],function(e,t){return Marionette.ItemView.extend({className:"modal",template:t,events:{"submit form":"joinRoom","click .js--skip":"close"},ui:{menu:".menu",form:".form--lobby"},serializeData:function(){return{hasWebRTC:e.request("connection:supported"),location:window.location.protocol+"//"+window.location.host,uuid:Math.uuid(8)}},onDomRefresh:function(){_.delay(function(){this.ui.menu.addClass("is-flipped")}.bind(this),2e3)},joinRoom:function(t){var n=this.ui.form[0].room_name.value;e.router.navigate(n,{trigger:!0}),t.preventDefault()},close:function(){this.$el.addClass("effect__fade-away"),_.delay(Marionette.ItemView.prototype.close.bind(this),500)
}})}),define("app/gatekeeper/core",["app/core","./views/Lobby"],function(e,t){var n=e.module("Gatekeeper",function(){this.startWithParent=!1,e.request("connection:supported")||e.modal.show(new t)});return n.on("start",function(){e.modal.show(new t)}),n.on("stop",function(){e.modal.reset()}),n}),require(["app/core","app/connection/core","app/navigation/core","app/halloween/core","app/gatekeeper/core"],function(e){e.start()}),define("setup",["hex","marionette"],function(e){return function(){var t;return t||e.Doppelganger}}(this)),function(e){if("function"==typeof bootstrap)bootstrap("simplewebrtc",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define("vendor/simplewebrtc",e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeSimpleWebRTC=e}else"undefined"!=typeof window?window.SimpleWebRTC=e():global.SimpleWebRTC=e()}(function(){return function(e,t,n){function i(n,o){if(!t[n]){if(!e[n]){var a="function"==typeof require&&require;if(!o&&a)return a(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+n+"'")}var s=t[n]={exports:{}};e[n][0].call(s.exports,function(t){var r=e[n][1][t];return i(r?r:t)},s,s.exports)}return t[n].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t){function n(e){var t,n,a=this,s=e||{},c=this.config={url:"http://signaling.simplewebrtc.com:8888",debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!0,peerVolumeWhenSpeaking:.25};this.logger=function(){return e.debug?e.logger||console:e.logger||l}();for(t in s)this.config[t]=s[t];this.capabilities=o,r.call(this),n=this.connection=io.connect(this.config.url),n.on("connect",function(){a.emit("connectionReady",n.socket.sessionid),a.sessionReady=!0,a.testReadiness()}),n.on("message",function(e){var t,n=a.webrtc.getPeers(e.from,e.roomType);"offer"===e.type?(t=n.length?n[0]:a.webrtc.createPeer({id:e.from,type:e.roomType,sharemyscreen:"screen"===e.roomType&&!e.broadcaster}),t.handleMessage(e)):n.length&&n.forEach(function(t){t.handleMessage(e)})}),n.on("remove",function(e){e.id!==a.connection.socket.sessionid&&a.webrtc.removePeers(e.id,e.type)}),e.logger=this.logger,e.debug=!1,this.webrtc=new i(e),["mute","unmute","pause","resume"].forEach(function(e){a[e]=a.webrtc[e].bind(a.webrtc)}),this.webrtc.on("*",function(){a.emit.apply(a,arguments)}),c.debug&&this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:")),this.webrtc.on("localStream",function(){a.testReadiness()}),this.webrtc.on("message",function(e){a.connection.emit("message",e)}),this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this)),this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this)),this.config.adjustPeerVolume&&(this.webrtc.on("speaking",this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1))),this.config.autoRequestMedia&&this.startLocalVideo()}var i=e("webrtc"),r=e("wildemitter"),o=e("webrtcsupport"),a=e("attachmediastream"),s=e("getscreenmedia"),l=e("mockconsole");n.prototype=Object.create(r.prototype,{constructor:{value:n}}),n.prototype.leaveRoom=function(){this.roomName&&(this.connection.emit("leave",this.roomName),this.webrtc.peers.forEach(function(e){e.end()}),this.getLocalScreen()&&this.stopScreenShare(),this.emit("leftRoom",this.roomName))},n.prototype.handlePeerStreamAdded=function(e){var t=this.getRemoteVideoContainer(),n=a(e.stream);e.videoEl=n,n.id=this.getDomId(e),t&&t.appendChild(n),this.emit("videoAdded",n,e)},n.prototype.handlePeerStreamRemoved=function(e){var t=this.getRemoteVideoContainer(),n=e.videoEl;this.config.autoRemoveVideos&&t&&n&&t.removeChild(n),n&&this.emit("videoRemoved",n,e)},n.prototype.getDomId=function(e){return[e.id,e.type,e.broadcaster?"broadcasting":"incoming"].join("_")},n.prototype.setVolumeForAll=function(e){this.webrtc.peers.forEach(function(t){t.videoEl&&(t.videoEl.volume=e)})},n.prototype.joinRoom=function(e,t){var n=this;this.roomName=e,this.connection.emit("join",e,function(i,r){if(i)n.emit("error",i);else{var o,a,s,l;for(o in r.clients){a=r.clients[o];for(s in a)a[s]&&(l=n.webrtc.createPeer({id:o,type:s}),l.start())}}t&&t(i,r),n.emit("joinedRoom",e)})},n.prototype.getEl=function(e){return"string"==typeof e?document.getElementById(e):e},n.prototype.startLocalVideo=function(){var e=this;this.webrtc.startLocalMedia(null,function(t,n){t?e.emit(t):a(n,e.getLocalVideoContainer(),{muted:!0,mirror:!0})})},n.prototype.stopLocalVideo=function(){this.webrtc.stopLocalMedia()},n.prototype.getLocalVideoContainer=function(){var e=this.getEl(this.config.localVideoEl);if(e&&"VIDEO"===e.tagName)return e;if(e){var t=document.createElement("video");return e.appendChild(t),t}},n.prototype.getRemoteVideoContainer=function(){return this.getEl(this.config.remoteVideosEl)},n.prototype.shareScreen=function(e){var t=this;s(function(n,i){var r=document.createElement("video"),o=t.getRemoteVideoContainer();n?t.emit(n):(t.webrtc.localScreen=i,r.id="localScreen",a(i,r),o&&o.appendChild(r),t.emit("localScreenAdded",r),t.connection.emit("shareScreen"),t.webrtc.peers.forEach(function(e){var n;"video"===e.type&&(n=t.webrtc.createPeer({id:e.id,type:"screen",sharemyscreen:!0,broadcaster:t.connection.socket.sessionid}),n.start())})),e&&e(n,i)})},n.prototype.getLocalScreen=function(){return this.webrtc.localScreen},n.prototype.stopScreenShare=function(){this.connection.emit("unshareScreen");var e=document.getElementById("localScreen"),t=this.getRemoteVideoContainer(),n=this.getLocalScreen();this.config.autoRemoveVideos&&t&&e&&t.removeChild(e),e&&this.emit("videoRemoved",e),n&&n.stop(),this.webrtc.peers.forEach(function(e){e.broadcaster&&e.end()}),delete this.webrtc.localScreen},n.prototype.testReadiness=function(){var e=this;this.webrtc.localStream&&this.sessionReady&&setTimeout(function(){e.emit("readyToCall",e.connection.socket.sessionid)},1e3)},n.prototype.createRoom=function(e,t){2===arguments.length?this.connection.emit("create",e,t):this.connection.emit("create",e)},n.prototype.sendFile=function(){return o.dataChannel?void 0:this.emit("error",new Error("DataChannelNotSupported"))},t.exports=n},{attachmediastream:4,getscreenmedia:6,mockconsole:7,webrtc:2,webrtcsupport:5,wildemitter:3}],3:[function(e,t){function n(){this.callbacks={}}t.exports=n,n.prototype.on=function(e){var t=3===arguments.length,n=t?arguments[1]:void 0,i=t?arguments[2]:arguments[1];return i._groupName=n,(this.callbacks[e]=this.callbacks[e]||[]).push(i),this},n.prototype.once=function(e){function t(){n.off(e,t),o.apply(this,arguments)}var n=this,i=3===arguments.length,r=i?arguments[1]:void 0,o=i?arguments[2]:arguments[1];return this.on(e,r,t),this},n.prototype.releaseGroup=function(e){var t,n,i,r;for(t in this.callbacks)for(r=this.callbacks[t],n=0,i=r.length;i>n;n++)r[n]._groupName===e&&(r.splice(n,1),n--,i--);return this},n.prototype.off=function(e,t){var n,i=this.callbacks[e];return i?1===arguments.length?(delete this.callbacks[e],this):(n=i.indexOf(t),i.splice(n,1),this):this},n.prototype.emit=function(e){var t,n,i=[].slice.call(arguments,1),r=this.callbacks[e],o=this.getWildcardCallbacks(e);if(r)for(t=0,n=r.length;n>t&&r[t];++t)r[t].apply(this,i);if(o)for(t=0,n=o.length;n>t&&o[t];++t)o[t].apply(this,[e].concat(i));return this},n.prototype.getWildcardCallbacks=function(e){var t,n,i=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[1].length)===n[1])&&(i=i.concat(this.callbacks[t]));return i}},{}],4:[function(e,t){t.exports=function(e,t,n){var i,r=window.URL,o={autoplay:!0,mirror:!1,muted:!1},a=t||document.createElement("video");if(n)for(i in n)o[i]=n[i];if(o.autoplay&&(a.autoplay="autoplay"),o.muted&&(a.muted=!0),o.mirror&&["","moz","webkit","o","ms"].forEach(function(e){var t=e?e+"Transform":"transform";a.style[t]="scaleX(-1)"}),r&&r.createObjectURL)a.src=r.createObjectURL(e);else if(a.srcObject)a.srcObject=e;else{if(!a.mozSrcObject)return!1;a.mozSrcObject=e}return a}},{}],5:[function(e,t){var n,i=!1,r=!1,o=navigator.userAgent.toLowerCase();-1!==o.indexOf("firefox")?(n="moz",r=!0):-1!==o.indexOf("chrome")&&(n="webkit",i=!0);var a=window.mozRTCPeerConnection||window.webkitRTCPeerConnection,s=window.mozRTCIceCandidate||window.RTCIceCandidate,l=window.mozRTCSessionDescription||window.RTCSessionDescription,c=window.webkitMediaStream||window.MediaStream,u=navigator.userAgent.match("Chrome")&&parseInt(navigator.userAgent.match(/Chrome\/(.*) /)[1],10)>=26,h=window.webkitAudioContext||window.AudioContext;t.exports={support:!!a,dataChannel:i||r||a.prototype&&a.prototype.createDataChannel,prefix:n,webAudio:!(!h||!h.prototype.createMediaStreamSource),mediaStream:!(!c||!c.prototype.removeTrack),screenSharing:!!u,AudioContext:h,PeerConnection:a,SessionDescription:l,IceCandidate:s}},{}],7:[function(e,t){for(var n="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),i=n.length,r=function(){},o={};i--;)o[n[i]]=r;t.exports=o},{}],6:[function(e,t){var n=e("getusermedia");t.exports=function(e){var t,i={video:{mandatory:{chromeMediaSource:"screen"}}};return"http:"===window.location.protocol?(t=new Error("NavigatorUserMediaError"),t.name="HTTPS_REQUIRED",e(t)):(n(i,e),void 0)}},{getusermedia:8}],9:[function(e,t){var n=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;t.exports=function(e,t){var i,r=2===arguments.length,o={video:!0,audio:!0},a="PERMISSION_DENIED",s="CONSTRAINT_NOT_SATISFIED";return r||(t=e,e=o),n?(n.call(navigator,e,function(e){t(null,e)},function(e){var n;"string"==typeof e?(n=new Error("NavigatorUserMediaError"),n.name=e===a?a:s):(n=e,n.name||(e.name=n[a]?a:s)),t(n)}),void 0):(i=new Error("NavigatorUserMediaError"),i.name="NOT_SUPPORTED_ERROR",t(i))}},{}],8:[function(e,t){var n=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;t.exports=function(e,t){var i,r=2===arguments.length,o={video:!0,audio:!0},a="PERMISSION_DENIED",s="CONSTRAINT_NOT_SATISFIED";return r||(t=e,e=o),n?(n.call(navigator,e,function(e){t(null,e)},function(e){var n;"string"==typeof e?(n=new Error("NavigatorUserMediaError"),n.name=e===a?a:s):(n=e,n.name||(e.name=n[a]?a:s)),t(n)}),void 0):(i=new Error("NavigatorUserMediaError"),i.name="NOT_SUPPORTED_ERROR",t(i))}},{}],2:[function(e,t){function n(e){var t=this,n=e||{};this.config={debug:!1,localVideoEl:"",remoteVideosEl:"",autoRequestMedia:!1,peerConnectionConfig:{iceServers:[{url:"stun:stun.l.google.com:19302"}]},peerConnectionContraints:{optional:[{DtlsSrtpKeyAgreement:!0},{RtpDataChannels:!0}]},autoAdjustMic:!1,media:{audio:!0,video:!0},detectSpeakingEvents:!0,enableDataChannels:!0};var i;this.screenSharingSupport=r.screenSharing,this.logger=function(){return e.debug?e.logger||console:e.logger||u}();for(i in n)this.config[i]=n[i];r.support||this.logger.error("Your browser doesn't seem to support WebRTC"),this.peers=[],s.call(this),this.config.debug&&this.on("*",function(e,n,i){var r;r=t.config.logger===u?console:t.logger,r.log("event:",e,n,i)})}function i(e){var t=this;if(this.id=e.id,this.parent=e.parent,this.type=e.type||"video",this.oneway=e.oneway||!1,this.sharemyscreen=e.sharemyscreen||!1,this.browserPrefix=e.prefix,this.stream=e.stream,this.channels={},this.pc=new a(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionContraints),this.pc.on("ice",this.onIceCandidate.bind(this)),this.pc.on("addStream",this.handleRemoteStreamAdded.bind(this)),this.pc.on("addChannel",this.handleDataChannelAdded.bind(this)),this.pc.on("removeStream",this.handleStreamRemoved.bind(this)),this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded")),this.logger=this.parent.logger,"screen"===e.type?this.parent.localScreen&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),this.pc.addStream(this.parent.localScreen),this.broadcaster=e.broadcaster):this.pc.addStream(this.parent.localStream),this.parent.config.enableDataChannels&&r.dataChannel){try{if(this.reliableChannel=this.getDataChannel("reliable",{reliable:!0}),!this.reliableChannel.reliable)throw Error("Failed to make reliable channel")}catch(n){this.logger.warn("Failed to create reliable data channel."),this.reliableChannel=!1,delete this.channels.reliable}try{if(this.unreliableChannel=this.getDataChannel("unreliable",{reliable:!1,preset:!0}),this.unreliableChannel.unreliable!==!1)throw Error("Failed to make unreliable channel")}catch(n){this.logger.warn("Failed to create unreliable data channel."),this.unreliableChannel=!1,delete this.channels.unreliableChannel}}s.call(this),this.on("*",function(){t.parent.emit.apply(t.parent,arguments)})}var r=e("webrtcsupport"),o=e("getusermedia"),a=e("rtcpeerconnection"),s=e("wildemitter"),l=e("hark"),c=e("mediastream-gain"),u=e("mockconsole");n.prototype=Object.create(s.prototype,{constructor:{value:n}}),n.prototype.createPeer=function(e){var t;return e.parent=this,t=new i(e),this.peers.push(t),t},n.prototype.startLocalMedia=function(e,t){var n=this,i=e||{video:!0,audio:!0};o(i,function(e,r){e||(i.audio&&n.config.detectSpeakingEvents&&n.setupAudioMonitor(r),n.localStream=r,n.config.autoAdjustMic&&(n.gainController=new c(r),n.setMicIfEnabled(.5)),n.emit("localStream",r)),t&&t(e,r)})},n.prototype.stopLocalMedia=function(){this.localStream&&(this.localStream.stop(),this.emit("localStreamStopped"))},n.prototype.mute=function(){this._audioEnabled(!1),this.hardMuted=!0,this.emit("audioOff")},n.prototype.unmute=function(){this._audioEnabled(!0),this.hardMuted=!1,this.emit("audioOn")},n.prototype.setupAudioMonitor=function(e){this.logger.log("Setup audio");var t,n=l(e),i=this;n.on("speaking",function(){i.hardMuted||(i.setMicIfEnabled(1),i.sendToAll("speaking",{}),i.emit("speaking"))}),n.on("stopped_speaking",function(){i.hardMuted||(t&&clearTimeout(t),t=setTimeout(function(){i.setMicIfEnabled(.5),i.sendToAll("stopped_speaking",{}),i.emit("stoppedSpeaking")},1e3))})},n.prototype.setMicIfEnabled=function(e){this.config.autoAdjustMic&&this.gainController.setGain(e)},n.prototype.pauseVideo=function(){this._videoEnabled(!1),this.emit("videoOff")},n.prototype.resumeVideo=function(){this._videoEnabled(!0),this.emit("videoOn")},n.prototype.pause=function(){this._audioEnabled(!1),this.pauseVideo()},n.prototype.resume=function(){this._audioEnabled(!0),this.resumeVideo()},n.prototype._audioEnabled=function(e){this.setMicIfEnabled(e?1:0),this.localStream.getAudioTracks().forEach(function(t){t.enabled=!!e})},n.prototype._videoEnabled=function(e){this.localStream.getVideoTracks().forEach(function(t){t.enabled=!!e})},n.prototype.removePeers=function(e,t){this.getPeers(e,t).forEach(function(e){e.end()})},n.prototype.getPeers=function(e,t){return this.peers.filter(function(n){return!(e&&n.id!==e||t&&n.type!==t)})},n.prototype.sendToAll=function(e,t){this.peers.forEach(function(n){n.send(e,t)})},i.prototype=Object.create(s.prototype,{constructor:{value:i}}),i.prototype.handleMessage=function(e){var t=this;this.logger.log("getting",e.type,e),e.prefix&&(this.browserPrefix=e.prefix),"offer"===e.type?this.pc.answer(e.payload,function(e,n){t.send("answer",n)}):"answer"===e.type?this.pc.handleAnswer(e.payload):"candidate"===e.type?this.pc.processIce(e.payload):"speaking"===e.type?this.parent.emit("speaking",{id:e.from}):"stopped_speaking"===e.type&&this.parent.emit("stopped_speaking",{id:e.from})},i.prototype.send=function(e,t){var n={to:this.id,broadcaster:this.broadcaster,roomType:this.type,type:e,payload:t,prefix:r.prefix};this.logger.log("sending",e,n),this.parent.emit("message",n)},i.prototype._observeDataChannel=function(e){var t=this;e.onclose=this.emit.bind(this,"channelClose",e),e.onerror=this.emit.bind(this,"channelError",e),e.onmessage=function(n){t.emit("message",e.label,n.data,e,n)},e.onopen=this.emit.bind(this,"channelOpen",e)},i.prototype.getDataChannel=function(e,t){if(!r.dataChannel)return this.emit("error",new Error("createDataChannel not supported"));var n=this.channels[e];return t||(t={}),n?n:(n=this.channels[e]=this.pc.createDataChannel(e,t),this._observeDataChannel(n),n)},i.prototype.onIceCandidate=function(e){this.closed||(e?this.send("candidate",e):this.logger.log("End of candidates."))},i.prototype.start=function(){var e=this;this.pc.offer(function(t,n){e.send("offer",n)})},i.prototype.end=function(){this.pc.close(),this.handleStreamRemoved()},i.prototype.handleRemoteStreamAdded=function(e){this.stream?this.logger.warn("Already have a remote stream"):(this.stream=e.stream,this.parent.emit("peerStreamAdded",this))},i.prototype.handleStreamRemoved=function(){this.parent.peers.splice(this.parent.peers.indexOf(this),1),this.closed=!0,this.parent.emit("peerStreamRemoved",this)},i.prototype.handleDataChannelAdded=function(e){this.channels[e.name]=e},t.exports=n},{getusermedia:9,hark:12,"mediastream-gain":11,mockconsole:7,rtcpeerconnection:10,webrtcsupport:5,wildemitter:3}],11:[function(e,t){function n(e){if(this.support=i.webAudio&&i.mediaStream,this.gain=1,this.support){var t=this.context=new i.AudioContext;this.microphone=t.createMediaStreamSource(e),this.gainFilter=t.createGain(),this.destination=t.createMediaStreamDestination(),this.outputStream=this.destination.stream,this.microphone.connect(this.gainFilter),this.gainFilter.connect(this.destination),e.removeTrack(e.getAudioTracks()[0]),e.addTrack(this.outputStream.getAudioTracks()[0])}this.stream=e}var i=e("webrtcsupport");n.prototype.setGain=function(e){this.support&&(this.gainFilter.gain.value=e,this.gain=e)},n.prototype.getGain=function(){return this.gain},n.prototype.off=function(){return this.setGain(0)},n.prototype.on=function(){this.setGain(1)},t.exports=n},{webrtcsupport:13}],13:[function(e,t){var n=window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.RTCPeerConnection,i=window.mozRTCIceCandidate||window.RTCIceCandidate,r=window.mozRTCSessionDescription||window.RTCSessionDescription,o=function(){return window.mozRTCPeerConnection?"moz":window.webkitRTCPeerConnection?"webkit":void 0}(),a=window.webkitMediaStream||window.MediaStream,s=navigator.userAgent.match("Chrome")&&parseInt(navigator.userAgent.match(/Chrome\/(.*) /)[1],10)>=26,l=window.webkitAudioContext||window.AudioContext;t.exports={support:!!n,dataChannel:!!(n&&n.prototype&&n.prototype.createDataChannel),prefix:o,webAudio:!(!l||!l.prototype.createMediaStreamSource),mediaStream:!(!a||!a.prototype.removeTrack),screenSharing:s,AudioContext:l,PeerConnection:n,SessionDescription:r,IceCandidate:i}},{}],10:[function(e,t){function n(e,t){var n;this.pc=new r.PeerConnection(e,t),i.call(this),this.pc.onremovestream=this.emit.bind(this,"removeStream"),this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded"),this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange"),this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange"),this.pc.onaddstream=this._onAddStream.bind(this),this.pc.onicecandidate=this._onIce.bind(this),this.pc.ondatachannel=this._onDataChannel.bind(this),this.config={debug:!1,sdpHack:!0};for(n in e)this.config[n]=e[n];this.config.debug&&this.on("*",function(){var t=e.logger||console;t.log("PeerConnection event:",arguments)})}var i=e("wildemitter"),r=e("webrtcsupport");n.prototype=Object.create(i.prototype,{constructor:{value:n}}),n.prototype.addStream=function(e){this.localStream=e,this.pc.addStream(e)},n.prototype.processIce=function(e){this.pc.addIceCandidate(new r.IceCandidate(e))},n.prototype.offer=function(e,t){var n=this,i=2===arguments.length,r=i?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},o=i?t:e;this.pc.createOffer(function(e){e.sdp=n._applySdpHack(e.sdp),n.pc.setLocalDescription(e),n.emit("offer",e),o&&o(null,e)},function(e){n.emit("error",e),o&&o(e)},r)},n.prototype.answerAudioOnly=function(e,t){var n={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}};this._answer(e,n,t)},n.prototype.answerBroadcastOnly=function(e,t){var n={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};this._answer(e,n,t)},n.prototype.answer=function(e,t,n){var i=3===arguments.length,r=i?n:t,o=i?t:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};this._answer(e,o,r)},n.prototype.handleAnswer=function(e){this.pc.setRemoteDescription(new r.SessionDescription(e))},n.prototype.close=function(){this.pc.close(),this.emit("close")},n.prototype._answer=function(e,t,n){var i=this;this.pc.setRemoteDescription(new r.SessionDescription(e)),this.pc.createAnswer(function(e){e.sdp=i._applySdpHack(e.sdp),i.pc.setLocalDescription(e),i.emit("answer",e),n&&n(null,e)},function(e){i.emit("error",e),n&&n(e)},t)},n.prototype._onIce=function(e){e.candidate?this.emit("ice",e.candidate):this.emit("endOfCandidates")},n.prototype._onDataChannel=function(e){this.emit("addChannel",e.channel)},n.prototype._onAddStream=function(e){this.remoteStream=e.stream,this.emit("addStream",e)},n.prototype._applySdpHack=function(e){if(!this.config.sdpHack)return e;var t=e.split("b=AS:30");return 2===t.length?t[0]+"b=AS:102400"+t[1]:e},n.prototype.createDataChannel=function(e,t){t||(t={});var n,i,o=!!t.reliable,a=t.protocol||"text/plain",s=!(!t.negotiated&&!t.preset);return"moz"===r.prefix?(n=o?{protocol:a,preset:s,stream:e}:{},i=this.pc.createDataChannel(e,n),i.binaryType="blob"):(n=o?{reliable:!0}:{reliable:!1},i=this.pc.createDataChannel(e,n)),i},t.exports=n},{webrtcsupport:5,wildemitter:3}],12:[function(e,t){function n(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var i=0,r=t.length;r>i;i++)t[i]>n&&t[i]<0&&(n=t[i]);return n}var i=e("wildemitter");t.exports=function(e,t){var r=new i;if(!window.webkitAudioContext)return r;var o,a,s,t=t||{},l=t.smoothing||.5,c=t.interval||100,u=t.threshold,h=t.play,p=new webkitAudioContext;s=p.createAnalyser(),s.fftSize=512,s.smoothingTimeConstant=l,a=new Float32Array(s.fftSize),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement?(o=p.createMediaElementSource(e),"undefined"==typeof h&&(h=!0),u=u||-65):(o=p.createMediaStreamSource(e),u=u||-45),o.connect(s),h&&s.connect(p.destination),r.speaking=!1,r.setThreshold=function(e){u=e},r.setInterval=function(e){c=e};var f=function(){setTimeout(function(){var e=n(s,a);r.emit("volume_change",e,u),e>u?r.speaking||(r.speaking=!0,r.emit("speaking")):r.speaking&&(r.speaking=!1,r.emit("stopped_speaking")),f()},c)};return f(),r}},{wildemitter:3}]},{},[1])(1)}),define("app/connection/models/stream",[],function(){return Backbone.Model.extend({})}),define("app/connection/collections/streams",["../models/stream"],function(e){return Backbone.Collection.extend({model:e})}),define("app/connection/controllers/webrtc",["app/core","vendor/simplewebrtc","app/connection/collections/streams"],function(e,t,n){return Marionette.Controller.extend({initialize:function(){var e=this.collection=new n;this.driver=new t({autoRequestMedia:!1,autoRemoveVideos:!1,localVideoEl:document.createElement("div"),remoteVideosEl:document.createElement("div"),url:window.location.protocol+"//"+window.location.host}),this.driver.on("readyToCall",this.boot.bind(this)),this.driver.on("videoAdded",this.addVideo.bind(this)),this.driver.on("videoRemoved",this.removeVideo.bind(this)),this.driver.connection.on("message",function(e){this.trigger("message",e),this.trigger("message:"+e.type,e)}.bind(this)),this.driver.on("speaking",function(t){t&&e.get(t.id).set("speaking",!0)}),this.driver.on("stoppedSpeaking",function(t){t&&e.get(t.id).set("speaking",!1)}),_(["mute","unmute","pause","resume"]).each(function(e){this[e]=function(){_.result(this.driver,e)}},this)},connect:function(){_.result(this.driver,"startLocalVideo")},disconnect:function(){_.result(this.driver,"leaveRoom"),_.result(this.driver,"stopLocalVideo"),this.collection.reset()},localVideo:function(){return this.driver.getEl(this.driver.config.localVideoEl).querySelector("video")},boot:function(e){this.collection.add({id:e,local:!0,videoEl:this.localVideo()}),this.resume(),this.driver.joinRoom(window.location.pathname.slice(1))},addVideo:function(e,t){this.collection.add(t),this.trigger("stream:added")},removeVideo:function(e,t){this.collection.remove(t.id),this.trigger("stream:removed")},send:function(e,t){this.driver.webrtc.sendToAll(e,t)}})}),define("app/connection/controllers/fallback",["app/core","app/connection/collections/streams"],function(e,t){return Marionette.Controller.extend({initialize:function(){this.collection=new t,this.driver={},_(["connect","localVideo","mute","unmute","pause","resume"]).each(function(e){this[e]=function(){}},this)},disconnect:function(){this.collection.reset()}})}),require(["setup"]);